(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function ot(t,e){for(let n in t)e(t[n],n)}function Pe(t,e,n=!1){if(t.parentElement!==e.parentElement)throw new Error("placeholder and element parentElement not same");let r=t;for(;r!==e;){const s=r;if(r=s.nextSibling,!r)throw new Error("can not find nextSibling");s.remove()}n&&e.remove()}const Le=t=>(t==null?void 0:t.constructor)===Object;function K(t,e){if(!t)throw new Error(e)}function te(t,e){if(t===e)return!0;if(typeof t!="object"||typeof e!="object"||t===null||e===null)return!1;const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(let s of n)if(t[s]!==e[s])return!1;return!0}const Re=/^(width|height|top|left|right|bottom|margin|padding|border|fontSize|maxWidth|maxHeight|minHeight|minWidth|gap)/;function ct(t,e,n){try{t[e]=n}catch(r){console.error(r)}}function lt(t){const e=this._listeners[t.type];return Array.isArray(e)?e.forEach(n=>n==null?void 0:n(t)):e==null?void 0:e(t)}function ht(t){const e=this._captureListeners[t.type];return Array.isArray(e)?e.forEach(n=>n==null?void 0:n(t)):e==null?void 0:e(t)}const he=new WeakMap;function ut(t){return t[0]==="o"&&t[1]==="n"}function pe(t,e,n,r){if(Array.isArray(n)&&e!=="style"&&e!=="className"&&!ut(e))return pe(t,e,n.at(-1),r);if(e==="uuid"){t.setAttribute("data-uuid",n);return}if(e[0]==="o"&&e[1]==="n"){const s=e!==(e=e.replace(/Capture$/,""));let i=e.toLowerCase().substring(2);i==="change"&&(i="input");const a=s?ht:lt;n?t.addEventListener(i,a,s):t.removeEventListener(i,a,s);const o=s?t._captureListeners||(t._captureListeners={}):t._listeners||(t._listeners={});K((o==null?void 0:o[i])===void 0,`${e} already listened`),o[i]=n;return}if(e==="style"){(!n||Array.isArray(n)&&!n.length)&&(t.style.cssText=n||""),(Array.isArray(n)?n:[n]).forEach(s=>{typeof s=="string"?t.style.cssText=s:typeof s=="object"?ot(s,(i,a)=>{i===void 0?t.style[a]="":t.style[a]=typeof i=="number"&&Re.test(a)?`${i}px`:i}):K(!1,"style can only be string or object.")});return}if(e==="className"){const s=Array.isArray(n)?n:[n];let i="";s.forEach(a=>{typeof a=="object"?Object.entries(a).forEach(([o,c])=>{c&&(i=`${i} ${o}`)}):typeof a=="string"?i=`${i} ${a}`:K(!1,"className can only be string or {[k:string]:boolean}")}),t.setAttribute("class",i);return}if(!(e==="key"||e==="ref"))if(e==="class"&&!r)t.className=n||"";else if(e==="value")t.value=n,t.tagName==="SELECT"?he.set(t,n):t.tagName==="OPTION"?je(t):t.tagName==="INPUT"&&t.type==="checkbox"?n?t.setAttribute("checked","true"):t.removeAttribute("checked"):t.tagName==="INPUT"&&t.type==="text"&&n===void 0&&(t.value="");else if(e==="checked"&&t.tagName==="INPUT"&&t.type==="checkbox")n?t.setAttribute("checked","true"):t.removeAttribute("checked");else if(e==="disabled")n?t.setAttribute("disabled","true"):t.removeAttribute("disabled");else if(e==="dangerouslySetInnerHTML")n&&(t.innerHTML=n||"");else if(e!=="list"&&e!=="type"&&!r&&e in t)ct(t,e,n===null?"":n),n==null&&t.removeAttribute(e);else{const s=r&&e!==(e=e.replace(/^xlink\:?/,""));n==null||n===!1?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):e.toLowerCase()==="contenteditable"&&n===!1?t.setAttribute(e,"false"):t.removeAttribute(e):typeof n!="function"&&s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),n):t.setAttribute(e,n)}}function M(t,e,...n){const{_isSVG:r,...s}=e||{};let i;const a=n.length?n:s.children||[];if(t===Ne)i=document.createDocumentFragment();else if(typeof t=="string")i=r?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);else return{type:t,props:s,children:a};const o=[],c=[],l=[];a==null||a.forEach((u,p)=>{if(u!=null)if(typeof u=="string"||typeof u=="number")i.appendChild(document.createTextNode(u.toString()));else if(u instanceof HTMLElement||u instanceof DocumentFragment||u instanceof SVGElement){i.appendChild(u);const g=u,v=g.unhandledChildren||[];c.push(...v.map(C=>({...C,path:[p,...C.path]})));const T=g.unhandledAttr||[];o.push(...T.map(C=>({...C,path:[p,...C.path]})));const A=g.refHandles||[];l.push(...A.map(C=>({...C,path:[p,...C.path]}))),delete g.unhandledChildren,delete g.unhandledAttr,delete g.refHandles}else{const g=document.createComment("unhandledChild");i.appendChild(g),c.push({placeholder:g,child:u,path:[p]})}}),s&&(s.ref&&(M.attachRef(i,s.ref),l.push({handle:s.ref,path:[]}),delete s.ref),Object.entries(s).forEach(([u,p])=>{M.isValidAttribute(u,p)?pe(i,u,p,r):o.push({el:i,key:u,value:p,path:[]})}));const h=i;return c.length&&(h.unhandledChildren=c),o&&(h.unhandledAttr=o),l.length&&(h.refHandles=l),i}function ft(t){return Le(t)&&Object.entries(t).every(([e,n])=>/[a-zA-Z\-]+/.test(e)&&typeof n=="string"||typeof n=="number")}M.isValidAttribute=function(t,e){return Array.isArray(e)?e.every(n=>M.isValidAttribute(t,n)):!!(typeof e!="object"&&typeof e!="function"||t[0]==="o"&&t[1]==="n"&&typeof e=="function"||(ft(e)||typeof e=="string")&&t==="style"||Le(e)&&t==="className")};M.attachRef=function(t,e){if(Array.isArray(e)){e.forEach(n=>M.attachRef(t,n));return}typeof e=="function"?e(t):typeof e=="object"&&e.hasOwnProperty("current")?e.current=t:K(!1,"ref should be function or object with current property")};M.detachRef=function(t){if(Array.isArray(t)){t.forEach(e=>M.detachRef(e));return}typeof t=="function"?t(null):typeof t=="object"&&t.hasOwnProperty("current")&&(t.current=null)};function Ne(){}function je(t){const e=t.parentElement;he.has(e)&&(e.value=he.get(e))}function V(t,e){const n=e.parentNode.insertBefore(t,e);return t.tagName==="OPTION"&&je(t),n}function dt(t,e,...n){return M(t,{_isSVG:!0,...e||{}},n)}function pt(t,e){const n=Object.create(null),r=t.split(",");for(let s=0;s<r.length;s++)n[r[s]]=!0;return e?s=>!!n[s.toLowerCase()]:s=>!!n[s]}const gt=Object.getOwnPropertyNames(Array.prototype),mt=new Set(gt.filter(t=>typeof Array.prototype[t]=="function")),yt=t=>mt.has(t),Et=Object.prototype.hasOwnProperty,oe=(t,e)=>Et.call(t,e),R=Array.isArray,ge=t=>Ee(t)==="[object Map]",Tt=t=>Ee(t)==="[object Set]",me=t=>typeof t=="string",ye=t=>typeof t=="symbol",kt=t=>t!==null&&typeof t=="object",vt=Object.prototype.toString,Ee=t=>vt.call(t),wt=t=>Ee(t).slice(8,-1),Z=t=>(t==null?void 0:t.constructor)===Object||(t==null?void 0:t.constructor)===Array,Ct=t=>me(t)&&(t[0]==="0"||t[0]==="1"||t[0]==="2"||t[0]==="3"||t[0]==="4"||t[0]==="5"||t[0]==="6"||t[0]==="7"||t[0]==="8"||t[0]==="9"),Te=t=>me(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Fe=(t,e)=>!Object.is(t,e),Q=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},At=t=>{const e=me(t)?Number(t):NaN;return isNaN(e)?t:e};function we(t){return typeof t=="string"||typeof t=="number"}function Ge(t){return Z(t)||R(t)||ge(t)||Tt(t)}function S(t,e){if(!t)throw new Error(e)}var b=(t=>(t.SKIP="__v_skip",t.IS_REACTIVE="__v_isReactive",t.IS_ATOM="__v_isAtom",t.IS_READONLY="__v_isReadonly",t.IS_SHALLOW="__v_isShallow",t.RAW="__v_raw",t))(b||{});const Ce=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Ke=t=>(t.w&f.trackOpBit)>0,$e=t=>(t.n&f.trackOpBit)>0,bt=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=f.trackOpBit},St=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const s=e[r];Ke(s)&&!$e(s)?s.delete(t):e[n++]=s,s.w&=~f.trackOpBit,s.n&=~f.trackOpBit}e.length=n}};var m=(t=>(t.ATOM="atom",t.GET="get",t.HAS="has",t.ITERATE="iterate",t.METHOD="method",t.EXPLICIT_KEY_CHANGE="explicit_key_change",t))(m||{}),d=(t=>(t.ATOM="atom",t.SET="set",t.ADD="add",t.DELETE="delete",t.CLEAR="clear",t.METHOD="method",t.EXPLICIT_KEY_CHANGE="explicit_key_change",t))(d||{});const It=new WeakSet,We=new WeakMap;function Ot(t){return new Proxy({},{get(e,n){const r=function(...i){return ne(i[0],n),t(...i)},s=Ye(t);return r.debug=function(...i){return ne(i[0],n),s(...i)},r}})}function xt(t){return new Proxy({},{get(e,n){return function(...r){return ne(r[0],n),t(...r)}}})}function Ye(t){return function(...e){return It.add(e[0]),t(...e)}}function Ht(t){return We.get(t)}function ne(t,e){return We.set(t,e)}function x(t,e,n){let r=t;function s(l){if(arguments.length===0)return f.instance.track(c,m.ATOM,"value"),r;if(r===l)return;const h=r;r=l,f.instance.trigger(c,d.ATOM,{key:"value",newValue:l,oldValue:h})}const i={get(l,h){return h==="raw"?r:h===b.IS_ATOM?!0:(Z(r)&&f.instance.track(c,m.ATOM,"value"),Reflect.get(Z(r)?r:a,h))},set(l,h,u){return typeof r=="object"?Reflect.set(r,h,u):!1},getPrototypeOf(){return r&&typeof r=="object"?Reflect.getPrototypeOf(r):null}},[a,o]=e?e(s,i):[s,i];Object.assign(a,{[Symbol.toPrimitive](l){return f.instance.track(c,m.ATOM,"value"),(!l||l==="default")&&we(r)||l==="number"&&typeof r=="number"?r:l==="string"?we(r)?r.toString():Object.prototype.toString.call(r):null}}),n&&ne(a,n),Q(a,b.IS_ATOM,!0);const c=new Proxy(a,o);return c}x.as=new Proxy({},{get(t,e){return(n,r)=>x(n,r,e)}});function O(t){return!!(t&&t.__v_isAtom)}const Be=class z{static collectEffect(){const e=[];return z.collectFrames.push(e),()=>(S(z.collectFrames.at(-1)===e,"collect effect frame error"),z.collectFrames.pop())}constructor(){const e=z.collectFrames.at(-1);e&&e.push(this)}destroy(){}};Be.collectFrames=[];let Dt=Be;const Xe=class G extends Dt{constructor(e){super(),this.active=e,this.deps=[],this.children=[],this.index=0,e&&G.activeScopes.length&&(this.parent=G.activeScopes.at(-1),this.parent.children.push(this),this.index=this.parent.children.length-1)}static destroy(e,n){var r;if(e.active){if(e.cleanup(),e.active=!1,e.parent&&!n){const s=e.parent.children.pop();s!==e&&(e.parent.children[e.index]=s,s.index=e.index)}delete e.parent,e.children.forEach(s=>{G.destroy(s,!0)}),e.children=[],(r=e.onDestroy)==null||r.call(e,e)}}effectFn(){}run(...e){if(!this.active)return this.effectFn();if(G.activeScopes.includes(this))throw new Error("recursive effect call");try{return f.trackOpBit=1<<++f.instance.effectTrackDepth,G.activeScopes.push(this),f.instance.enableTracking(),f.instance.effectTrackDepth<=ue?bt(this):this.cleanup(),this.children.forEach(n=>G.destroy(n,!0)),this.children=[],this.effectFn()}finally{f.instance.effectTrackDepth<=ue&&St(this),f.instance.resetTracking(),G.activeScopes.pop(),f.trackOpBit=1<<--f.instance.effectTrackDepth}}cleanup(){const{deps:e}=this;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(this);e.length=0}}destroy(){G.destroy(this)}};Xe.activeScopes=[];let L=Xe;function Mt(t,e){if(Array.isArray(t))t.splice(0,1/0,...e);else if(Z(t)){const n=Object.keys(e);Object.keys(t).filter(r=>!n.includes(r)).forEach(r=>delete t[r]),Object.assign(t,e)}else if(t instanceof Map){for(const n of t.keys())e.has(n)?t.set(n,e.get(n)):t.delete(n);for(const n of e.keys())t.has(n)||t.set(n,e.get(n))}else t instanceof Set?(t.forEach(n=>{e.has(n)||t.delete(n)}),e.forEach(n=>{t.has(n)||t.add(n)})):S(!1,"unknown source type to replace data")}const ze=new WeakMap;function $(t){const e=ze.get(t);L.destroy(e)}class ce extends L{constructor(e,n,r,s,i,a,o){if(super(!!e),this.getter=e,this.applyPatch=n,this.callbacks=s,this.skipIndicator=i,this.forceAtom=a,this.keepRaw=o,this.isDirty=!1,this.immediate=!1,this.recomputing=!1,this.triggerInfos=[],this.effectFramesArray=[],this.keyToEffectFrames=new WeakMap,this.recompute=(l=!1)=>{var h,u;if(!(!this.isDirty&&!l)){if((u=(h=this.callbacks)==null?void 0:h.onRecompute)==null||u.call(h,this.data),l||!this.applyPatch){const p=super.run();this.replaceData(p)}else f.instance.pauseTracking(),this.applyPatch.call(this,this.data,this.triggerInfos),f.instance.resetTracking(),this.triggerInfos.length=0;this.isDirty=!1}},this.manualTrack=(l,h,u)=>{f.instance.enableTracking();const p=f.instance.track(O(l)?l:k(l),h,u);return f.instance.resetTracking(),p},this.collectEffect=L.collectEffect,this.destroyEffect=L.destroy,!e)return;typeof r=="function"?this.scheduleRecompute=r:this.immediate=!0,s!=null&&s.onDestroy&&(this.onDestroy=s.onDestroy),s!=null&&s.onTrack&&(this.onTrack=s.onTrack);const c=super.run();this.data=this.keepRaw?c:this.forceAtom?x(c):Ge(c)?X(c):x(c),this.keepRaw||ze.set(this.data,this)}get debugName(){return Ht(this.data)}effectFn(){if(this.applyPatch){f.instance.pauseTracking();const e=this.getter.call(this);return f.instance.resetTracking(),e}else return this.getter.call(this)}run(e){var n;(n=this.skipIndicator)!=null&&n.skip||(this.triggerInfos.push(...e),this.isDirty=!0,this.immediate?this.recompute():this.scheduleRecompute(this.recompute))}replaceData(e){O(this.data)?(Ae.get(this.data.raw)&&Ae.get(this.data.raw)(this.data.raw),this.data(e)):Mt(this.data,e)}}function P(t,e,n,r,s,i){return new ce(t,e,n,r,s,i).data}function U(t,e,n,r,s){return new ce(t,e,n,r,s,!0).data}P.as=Ot(P);P.debug=Ye(P);const Ae=new WeakMap,H=Symbol("iterate"),re=Symbol("Map key iterate"),ue=30,qe=class q{constructor(){this.targetMap=new WeakMap,this.arrayExplicitKeyDepCount=new WeakMap,this.shouldTrack=!0,this.effectTrackDepth=0,this.frameStack=[],this.triggerStack=[],this.shouldTrigger=!0,this.trackStack=[],this.effectsInSession=new Set,this.effectsInSessionPayloads=new WeakMap,this.inEffectSession=!1,this.isDigesting=!1,this.sessionDepth=0,this.track=(e,n,r)=>{if(!L.activeScopes.at(-1)||!this.shouldTrack)return;let s=this.targetMap.get(e);s||this.targetMap.set(e,s=new Map);let i=s.get(r);i||s.set(r,i=Ce());const a=void 0;if(R(e)&&Ct(r)){let o=this.arrayExplicitKeyDepCount.get(e)||0;this.arrayExplicitKeyDepCount.set(e,++o)}return this.trackEffects(i,a),i}}static get instance(){return q._instance||(q._instance=new q)}createEffectSession(){this.isDigesting||(this.inEffectSession=!0,this.sessionDepth++)}scheduleEffect(e,n,r){this.effectsInSession.add(e);let s=this.effectsInSessionPayloads.get(e);s||this.effectsInSessionPayloads.set(e,s=[]),s.push(n)}digestEffectSession(){if(this.isDigesting||(this.sessionDepth--,this.sessionDepth>0))return;this.isDigesting=!0;const e=this.effectsInSession[Symbol.iterator]();let n;for(;n=e.next().value;){const r=this.effectsInSessionPayloads.get(n);n.run(r),this.effectsInSession.delete(n),this.effectsInSessionPayloads.delete(n)}this.inEffectSession=!1,this.isDigesting=!1}trackEffects(e,n){const r=L.activeScopes.at(-1);if(!r)return;let s=!1;this.effectTrackDepth<=ue?$e(e)||(e.n|=q.trackOpBit,s=!Ke(e)):s=!e.has(r),s&&(e.add(r),r.deps.push(e),this.frameStack.length&&this.frameStack.at(-1).deps.push(e))}trigger(e,n,r,s){if(!this.shouldTrigger)return;const i={...r,source:e,type:n},{key:a,newValue:o,oldValue:c}=i,l=this.targetMap.get(e);if(!l)return;let h=[];if(n===d.CLEAR)h=[...l.values()];else if(a==="length"&&R(e)){const u=At(o);l.forEach((p,g)=>{(g==="length"||g>=u)&&h.push(p)})}else switch(a!==void 0&&h.push(l.get(a)),n){case d.ADD:R(e)?Te(a)&&h.push(l.get("length")):(h.push(l.get(H)),h.push(l.get(re)));break;case d.DELETE:R(e)||(h.push(l.get(H)),h.push(l.get(re)));break;case d.SET:R(e)||h.push(l.get(H));break;case d.METHOD:h.push(l.get(d.METHOD));break;case d.EXPLICIT_KEY_CHANGE:h.push(l.get(d.EXPLICIT_KEY_CHANGE));break}if(h.length===1)h[0]&&this.triggerEffects(h[0],i);else{const u=[];for(const p of h)p&&u.push(...p);this.triggerEffects(Ce(u),i)}}triggerEffects(e,n,r){const s=R(e)?e:[...e];for(const i of s)this.triggerEffect(i,n,r)}triggerEffect(e,n,r){this.inEffectSession?this.scheduleEffect(e,n,r):e.run([n],r)}enableTracking(){this.trackStack.push(this.shouldTrack),this.shouldTrack=!0}pauseTracking(){this.trackStack.push(this.shouldTrack),this.shouldTrack=!1}resetTracking(){const e=this.trackStack.pop();this.shouldTrack=e===void 0?!0:e}};qe.trackOpBit=1;let f=qe;const se=new Map;function _t(t,e){const n=t[1]===void 0?t.length<2?1/0:0:t[1],r=n<0?0:n;return r!==1/0?r:e-t[0]}function Vt(t){S(Array.isArray(t),"only array source can have atom indexes");let e=se.get(t);if(!e){const n=t.map((r,s)=>x(s));e={depCount:0,indexes:n,computed:P(function(){this.manualTrack(t,m.METHOD,d.METHOD)},function(r,s){s.forEach(({method:i,argv:a})=>{if(S(!!i,"trigger info has no method and result"),i==="push"){const o=a.map((c,l)=>x(l+n.length));n.push(...o)}else if(i==="pop")n.pop();else if(i==="shift")n.shift();else if(i==="unshift")n.forEach(o=>o(c=>c+a.length)),n.unshift(...a.map((o,c)=>x(c)));else if(i==="splice"){const o=_t(a,n.length),c=a.slice(2).map((l,h)=>x(h+a[0]));if(n.splice(a[0],a[1],...c),o!==c.length)for(let l=a[0]+o;l<n.length;l++)n[l](l)}})},function(r){r()})},se.set(t,e)}return e.depCount++,e.indexes}function Pt(t){const e=se.get(t);S(!!e,"no dep for this array source found."),e.depCount--,e.depCount<1&&($(e.computed),se.delete(t))}function Lt(t,e){if(!ke(t)){if(Array.isArray(t))return t.map((s,i)=>e(s,()=>i));if(t instanceof Map)return new Map(Object.entries(t).map(([s,i])=>[s,e(i,s)]));if(t instanceof Set)return new Set(Array.from(t).map(e));S(!1,"unknown source type for incMap")}let n,r;return e.length>1&&(f.instance.pauseTracking(),r=Array.isArray(t)?Vt(t):void 0,f.instance.resetTracking()),P(function(){const{manualTrack:s,collectEffect:i}=this;if(s(t,m.METHOD,d.METHOD),s(t,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),Array.isArray(t)?this.effectFramesArray=[]:this.keyToEffectFrames=new WeakMap,Array.isArray(t))return t.map((a,o)=>{const c=i(),l=e(a,r==null?void 0:r[o]);return this.effectFramesArray[o]=c(),l});if(t instanceof Map)return new Map(Array.from(t.entries()).map(([a,o])=>{const c=i(),l=e(o,a);return this.keyToEffectFrames.set(a,c()),[a,l]}));if(t instanceof Set){n=new Map;const a=Array.from(t.values()).map(o=>{const c=i(),l=e(o);return this.keyToEffectFrames.set(o,c()),n.set(o,l),l});return new Set(a)}else S(!1,"non-support map source type")},function(s,i){const{collectEffect:a,destroyEffect:o}=this;i.forEach(({method:c,argv:l,result:h,key:u,newValue:p})=>{var g,v,T,A,C;if(S(!!(c==="splice"||h),"trigger info has no method and result"),Array.isArray(t))if(c==="splice"){const E=l.slice(2),y=[],w=E.map((I,F)=>{const st=t[F+l[0]],it=a(),at=e(st,r==null?void 0:r[F+l[0]]);return y[F]=it(),at});s.splice(l[0],l[1],...w),this.effectFramesArray.splice(l[0],l[1],...y).forEach(I=>{I.forEach(F=>{o(F)})})}else{const E=u,y=a();s[E]=e(t[E],r==null?void 0:r[E]);const w=y();this.effectFramesArray[E].forEach(I=>{o(I)}),this.effectFramesArray[E]=w}else if(t instanceof Map)if(c==="clear"){const E=Array.from(s.keys());s.clear(),E.forEach(y=>{this.keyToEffectFrames.get(y).forEach(w=>{o(w)})})}else!c&&h&&((g=h.add)==null||g.forEach(({key:E,newValue:y})=>{const w=a();s.set(E,e(y));const I=w();this.keyToEffectFrames.set(E,I)}),(v=h.update)==null||v.forEach(({key:E,newValue:y})=>{const w=a();s.set(E,e(y));const I=w();this.keyToEffectFrames.get(E).forEach(F=>{o(F)}),this.keyToEffectFrames.set(E,I)}),(T=h.remove)==null||T.forEach(({key:E})=>{s.remove(E),this.keyToEffectFrames.get(E).forEach(y=>{o(y)})}));else if(t instanceof Set)if(c==="clear"){const E=Array.from(s.values());s.clear(),E.forEach(y=>{this.keyToEffectFrames.get(y).forEach(w=>{o(w)})})}else!c&&h&&((A=h.add)==null||A.forEach(({newValue:E})=>{const y=a();s.add(e(E));const w=y();this.keyToEffectFrames.set(E,w)}),(C=h.remove)==null||C.forEach(({oldValue:E})=>{const y=n.get(E);s.remove(y),this.keyToEffectFrames.get(E).forEach(w=>{o(w)})}))})},function(s){s()},{onDestroy(){n==null||n.clear(),Array.isArray(t)&&e.length>1&&Pt(t)}})}const Rt=pt(`constructor,__proto__,__v_isAtom,${b.IS_REACTIVE}}`),Je=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ye)),Nt=Ft(),be=jt(),_=new WeakSet;function jt(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=k(this);for(let i=0,a=this.length;i<a;i++)f.instance.track(r,m.GET,i+"");const s=r[e](...n);return s===-1||s===!1?r[e](...n.map(k)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){const r=k(this),s=r.length;f.instance.pauseTracking(),_.add(r),f.instance.createEffectSession();let i;f.instance.arrayExplicitKeyDepCount.get(r)?i=r[e].apply(this,n):(i=r[e].apply(r,n),f.instance.trigger(r,d.SET,{key:"length",newValue:i.length})),_.delete(r);let a;return e==="splice"?a=n:e==="push"?a=[s,0,...n]:e==="pop"?a=[s-1,1]:e==="shift"?a=[0,1]:e==="unshift"&&(a=[0,0,...n]),f.instance.trigger(r,d.METHOD,{method:"splice",argv:a}),f.instance.digestEffectSession(),f.instance.resetTracking(),i}}),t.$map=function(e){return Lt(this,e)},t}function Ft(t=!1,e=!1){return function(n,r,s){if(r===b.IS_REACTIVE)return!t;if(r===b.IS_ATOM)return!1;if(r===b.IS_READONLY)return t;if(r===b.IS_SHALLOW)return e;if(r===b.RAW&&s===(e?ln:Ue).get(n))return n;const i=R(n);if(!t&&i&&oe(be,r))return Reflect.get(be,r,s);const a=typeof r=="string"&&r[0]==="$",o=a?r.slice(1,1/0):r,c=Reflect.get(n,o,s);return!Se(o)&&!(i&&yt(r))&&f.instance.track(n,m.GET,o),a?Gt(n,o):Se(o)||O(c)||i&&!Te(o)?c:Z(c)?X(c):c}}function Se(t){return ye(t)?Je.has(t):Rt(t)}function Gt(t,e){function n(r){if(arguments.length===0)return f.instance.track(t,m.GET,e),Reflect.get(t,e);const s=Reflect.get(t,e);Reflect.set(t,e,r),f.instance.trigger(t,d.SET,{key:e,newValue:r,oldValue:s}),_.has(k(t))||f.instance.trigger(t,d.EXPLICIT_KEY_CHANGE,{result:{update:[{key:e,oldValue:s,newValue:r}]}})}return n.toString=()=>{var r;return f.instance.track(t,m.GET,e),(r=Reflect.get(t,e))==null?void 0:r.toString()},n.valueOf=()=>{var r;return f.instance.track(t,m.GET,e),(r=Reflect.get(t,e))==null?void 0:r.valueOf()},Q(n,b.IS_REACTIVE,!0),Q(n,b.IS_ATOM,!0),n}const Kt=$t();function $t(t=!1){return function(e,n,r,s){let i=e[n];if(O(i)&&!O(r))return!1;O(r)&&console.warn(`you are assign an atom to ${n.toString()}`),r=k(r);const a=R(e)&&Te(n)?Number(n)<e.length:oe(e,n),o=Reflect.set(e,n,r,s);return e===k(s)&&(a?Fe(r,i)&&(f.instance.trigger(e,d.SET,{key:n,newValue:r,oldValue:i}),_.has(k(e))||f.instance.trigger(e,d.EXPLICIT_KEY_CHANGE,{key:n,newValue:r,result:{update:[{key:n,oldValue:i,newValue:r}]}})):(f.instance.trigger(e,d.ADD,{key:n,newValue:r}),_.has(k(e))||f.instance.trigger(e,d.EXPLICIT_KEY_CHANGE,{key:n,newValue:r,result:{add:[{key:n,newValue:r}]}}))),o}}function Wt(t,e){const n=oe(t,e),r=t[e],s=Reflect.deleteProperty(t,e);return s&&n&&(f.instance.trigger(t,d.DELETE,{key:e,newValue:void 0,oldValue:r}),_.has(k(t))||f.instance.trigger(t,d.EXPLICIT_KEY_CHANGE,{result:{remove:[{key:e,oldValue:r}]}})),s}function Yt(t,e){const n=Reflect.has(t,e);return(!ye(e)||!Je.has(e))&&f.instance.track(t,m.HAS,e),n}function Bt(t){return f.instance.track(t,m.ITERATE,R(t)?"length":re),Reflect.ownKeys(t)}const Xt={get:Nt,set:Kt,deleteProperty:Wt,has:Yt,ownKeys:Bt},ee=t=>Reflect.getPrototypeOf(t);function zt(t,e,n=!1){t=t[b.RAW];const r=k(t),s=k(e);n||(e!==s&&f.instance.track(r,m.GET,e),f.instance.track(r,m.GET,s));const{has:i}=ee(r);if(i.call(r,e))return B(t.get(e));if(i.call(r,s))return B(t.get(s));t!==r&&t.get(e)}function qt(t,e,n=!1){t=t[b.RAW];const r=k(t),s=k(e);n||(e!==s&&f.instance.track(r,m.GET,e),f.instance.track(r,m.GET,s));const{has:i}=ee(r);if(i.call(r,e))return Ie(t,e);if(i.call(r,s))return Ie(t,s);S(!1,`can not find key ${e.toString()}`)}function Ie(t,e){function n(r){if(arguments.length===0)return f.instance.track(t,m.GET,e),t.get(e);const s=t.get(e);t.set(e,r),f.instance.trigger(t,d.SET,{key:e,newValue:r,oldValue:s}),_.has(k(t))||f.instance.trigger(t,d.EXPLICIT_KEY_CHANGE,{result:{update:[{key:e,oldValue:s,newValue:r}]}})}return n.toString=()=>{var r;return f.instance.track(t,m.GET,e),(r=t.get(e))==null?void 0:r.toString()},n.valueOf=()=>{var r;return f.instance.track(t,m.GET,e),(r=t.get(e))==null?void 0:r.valueOf()},Q(n,b.IS_REACTIVE,!0),Q(n,b.IS_ATOM,!0),n}function Jt(t,e=!1){const n=this[b.RAW],r=k(n),s=k(t);return e||(t!==s&&f.instance.track(r,m.HAS,t),f.instance.track(r,m.HAS,s)),t===s?n.has(t):n.has(t)||n.has(s)}function Ut(t,e=!1){return t=t[b.RAW],!e&&f.instance.track(k(t),m.ITERATE,H),Reflect.get(t,"size",t)}function Zt(t){t=k(t);const e=k(this);return ee(e).has.call(e,t)||(e.add(t),f.instance.trigger(e,d.ADD,{newValue:t}),_.has(k(e))||f.instance.trigger(e,d.EXPLICIT_KEY_CHANGE,{result:{add:[{newValue:t}]}})),this}function Qt(t,e){e=k(e);const n=k(this),{has:r,get:s}=ee(n);let i=r.call(n,t);i||(t=k(t),i=r.call(n,t));const a=s.call(n,t);return n.set(t,e),i?Fe(e,a)&&(f.instance.trigger(n,d.SET,{key:t,newValue:e,oldValue:a}),_.has(n)||f.instance.trigger(n,d.EXPLICIT_KEY_CHANGE,{result:{update:[{key:t,oldValue:a,newValue:e}]}})):(f.instance.trigger(n,d.ADD,{key:t,newValue:e}),_.has(n)||f.instance.trigger(n,d.EXPLICIT_KEY_CHANGE,{result:{add:[{key:t,oldValue:a}]}})),this}function en(t){const e=k(this),{has:n,get:r}=ee(e);let s=n.call(e,t);s||(t=k(t),s=n.call(e,t));const i=r?r.call(e,t):void 0,a=e.delete(t);return s&&(f.instance.trigger(e,d.DELETE,{key:t,newValue:void 0,oldValue:i}),_.has(k(e))||f.instance.trigger(e,d.EXPLICIT_KEY_CHANGE,{result:{remove:[{key:t,oldValue:i}]}})),a}function tn(){const t=k(this),e=t.size!==0,n=void 0;_.add(t);const r=t.clear();return _.delete(t),e&&(f.instance.trigger(t,d.CLEAR,{},n),f.instance.trigger(t,d.METHOD,{method:"clear"},n)),r}function nn(t,e){return function(n,r){const s=this,i=s[b.RAW],a=k(i);return!t&&f.instance.track(a,m.ITERATE,H),i.forEach((o,c)=>n.call(r,B(o),B(c),s))}}function rn(t,e,n){return function(...r){const s=this[b.RAW],i=k(s),a=ge(i),o=t==="entries"||t===Symbol.iterator&&a,c=t==="keys"&&a,l=s[t](...r);return!e&&f.instance.track(i,m.ITERATE,c?re:H),{next(){const{value:h,done:u}=l.next();return u?{value:h,done:u}:{value:o?[B(h[0]),B(h[1])]:B(h),done:u}},[Symbol.iterator](){return this}}}}function sn(){const t={get(e){return zt(this,e)},$get(e){return qt(this,e)},get size(){return Ut(this)},has:Jt,add:Zt,set:Qt,delete:en,clear:tn,forEach:nn(!1)};return["keys","values","entries",Symbol.iterator].forEach(e=>{t[e]=rn(e,!1)}),[t]}const[Oe]=sn(),an="$get";function on(t){return(e,n,r)=>n===b.IS_REACTIVE?!t:n===b.IS_READONLY?t:n===b.RAW?e:Reflect.get(oe(Oe,n)&&(n in e||n===an&&e instanceof Map)?Oe:e,n,r)}const cn={get:on(!1)},Ue=new WeakMap,ln=new WeakMap;function hn(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function un(t){return t[b.SKIP]||!Object.isExtensible(t)?0:hn(wt(t))}function X(t,e){const n=[t,!1,Xt,cn,Ue],r=e?e(...n):n;return fn(...r)}X.as=xt(X);function fn(t,e,n,r,s){if(!kt(t)||t[b.RAW])return t;const i=s.get(t);if(i)return i;const a=un(t);if(a===0)return t;const o=new Proxy(t,a===2?r:n);return s.set(t,o),o}function ke(t){return!!(t&&t[b.IS_REACTIVE])}function k(t){const e=t&&t[b.RAW];return e?k(e):t}const B=t=>Ge(t)?X(t):t;class ie extends ce{constructor(e,n,r,s,i,a,o){super(n,r,s,i,a,o),this.getter=n,this.applyPatch=r,this.callbacks=i,this.skipIndicator=a,this.forceAtom=o,this.replace=c=>{this.data.clear();const l=Array.isArray(c)?c:Object.entries(c);this.data=new Map(l),l.forEach(([h,u])=>{f.instance.trigger(this,d.ADD,{key:h,newValue:u})}),f.instance.trigger(this,d.METHOD,{method:"replace",argv:[c]})},this.replaceData=this.replace,e&&(this.data=ge(e)?e:new Map(Array.isArray(e)?e:Object.entries(e)))}set(e,n){const r=this.data.has(e),s=this.data.get(e);this.data.set(e,n),r?f.instance.trigger(this,d.SET,{key:e,newValue:n,oldValue:s}):f.instance.trigger(this,d.ADD,{key:e,newValue:n})}delete(e){if(this.data.has(e)){const n=this.data.get(e);this.data.delete(e),f.instance.trigger(this,d.DELETE,{key:e,newValue:void 0,oldValue:n})}}clear(){const e=Array.from(this.data.entries());this.data.clear(),e.forEach(([n,r])=>{f.instance.trigger(this,d.DELETE,{key:n,oldValue:r})}),f.instance.trigger(this,d.METHOD,{method:"clear"})}get(e){const n=this.data.get(e);return f.instance.track(this,m.GET,e),n}forEach(e){for(let[n,r]of this.data)e(r,n);f.instance.track(this,m.ITERATE,H)}[Symbol.iterator](){let e=0,n=this.data;f.instance.track(this,m.ITERATE,H);const r=Array.from(n.keys());return{next:()=>e<r.length?{value:[this.get(r[e]),r[e]],done:!1}:{done:!0}}}entries(){const e=this,n=[];return new D(null,function(){return this.manualTrack(e,m.ITERATE,H),this.manualTrack(e,m.METHOD,d.METHOD),n.push(...e.data.keys()),Array.from(e.data.entries())},function(r,s){s.forEach(i=>{if(i.type===d.METHOD)i.method==="clear"?(this.splice(0,this.data.length),n.splice(0,n.length)):S(!1,"unreachable");else{const a=i.key,o=i.newValue;if(i.type===d.ADD)this.push([a,o]),n.push(a);else if(i.type===d.SET){const c=n.indexOf(a);this.set(c,[a,o])}else if(i.type===d.DELETE){const c=n.indexOf(a);this.splice(c,1),n.splice(c,1)}else S(!1,"unreachable")}})})}values(){const e=this;return new D(null,function(){return this.manualTrack(e,m.ITERATE,H),this.manualTrack(e,m.METHOD,d.METHOD),Array.from(e.data.values())},function(n,r){r.forEach(s=>{if(s.type===d.METHOD)s.method==="clear"?this.splice(0,this.data.length):S(!1,"unreachable");else if(s.type===d.ADD)this.push(s.newValue);else if(s.type===d.SET){const i=this.data.indexOf(s.oldValue);this.splice(i,1,s.newValue)}else if(s.type===d.DELETE){const i=this.data.indexOf(s.oldValue);this.splice(i,1)}else S(!1,"unreachable")})})}keys(){const e=this;return new D(null,function(){return this.manualTrack(e,m.ITERATE,H),this.manualTrack(e,m.METHOD,d.METHOD),Array.from(e.data.keys())},function(n,r){r.forEach(s=>{if(s.type===d.METHOD)s.method==="clear"?this.splice(0,this.data.length):S(!1,"unreachable");else{const i=s.key;if(s.type===d.ADD)this.push(i);else if(s.type!==d.SET)if(s.type===d.DELETE){const a=this.data.indexOf(i);this.splice(a,1)}else S(!1,"unreachable")}})})}get size(){const e=this;return U(function(){return this.manualTrack(e,m.ITERATE,H),e.data.size},function(n,r){n(e.data.size)})}}class D extends ce{constructor(e,n,r,s,i){super(n,r,s,i,void 0,void 0,!0),this.getter=n,this.applyPatch=r,this.callbacks=i,this.indexKeyDeps=new Map,this.atomIndexesDepCount=0,e&&(this.data=e)}replaceData(e){this.splice(0,this.data.length,...e)}push(...e){return this.splice(this.data.length,0,...e)}pop(){return this.splice(this.data.length-1,1)[0]}shift(){return this.splice(0,1)[0]}unshift(...e){return this.splice(0,0,...e)}splice(e,n,...r){var s,i,a;f.instance.pauseTracking(),f.instance.createEffectSession();const o=this.data.length,c=Math.min(n,o-e)!==r.length?this.data.length:e+r.length,l=[];for(let u=e;u<c;u++)l[u]=this.data[u];const h=this.data.splice(e,n,...r);if(((s=this.indexKeyDeps)==null?void 0:s.size)>0)for(let u=e;u<c;u++)f.instance.trigger(this,d.SET,{key:u,newValue:this.data[u],oldValue:l[u]});if(this.atomIndexes){this.atomIndexes.splice(e,n,...r.map((u,p)=>x(p+e)));for(let u=e;u<c;u++)(a=(i=this.atomIndexes)[u])==null||a.call(i,u)}return f.instance.trigger(this,d.METHOD,{method:"splice",key:H,argv:[e,n,...r],methodResult:h}),f.instance.digestEffectSession(),f.instance.resetTracking(),h}set(e,n){const r=this.data[e];this.data[e]=n,e>this.data.length-1?f.instance.trigger(this,d.ADD,{key:e,newValue:n,oldValue:r}):f.instance.trigger(this,d.SET,{key:e,newValue:n,oldValue:r}),f.instance.trigger(this,d.EXPLICIT_KEY_CHANGE,{key:e,newValue:n,oldValue:r})}at(e){const n=f.instance.track(this,m.GET,e);return n&&!this.indexKeyDeps.has(e)&&this.indexKeyDeps.set(e,n),this.data[e]}forEach(e){for(let n=0;n<this.data.length;n++)e(this.at(n),n);f.instance.track(this,m.ITERATE,H)}[Symbol.iterator](){let e=0,n=this.data;return f.instance.track(this,m.ITERATE,H),{next:()=>e<n.length?{value:this.at(e),done:!1}:{done:!0}}}addAtomIndexesDep(){this.atomIndexesDepCount===0&&(this.atomIndexes=this.data.map((e,n)=>x(n))),this.atomIndexesDepCount++}removeAtomIndexesDep(){this.atomIndexesDepCount--,this.atomIndexesDepCount===0&&(this.atomIndexes=void 0)}map(e,n,r){const s=this;return e.length>1&&s.addAtomIndexesDep(),new D(null,function(){return this.manualTrack(s,m.METHOD,d.METHOD),this.manualTrack(s,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),s.data.map((i,a)=>{var o;const c=L.collectEffect(),l=e(s.at(a),(o=s.atomIndexes)==null?void 0:o[a]);return this.effectFramesArray[a]=c(),l})},function(i,a){a.forEach(o=>{var c;const{method:l,argv:h,key:u}=o;if(S(!!(l==="splice"||u),"trigger info has no method and key"),n&&n(o),l==="splice"){const p=h.slice(2),g=[],v=p.map((T,A)=>{var C;const E=s.at(A+h[0]),y=this.collectEffect(),w=e(E,(C=s.atomIndexes)==null?void 0:C[A+h[0]]);return g[A]=y(),w});this.splice(h[0],h[1],...v),this.effectFramesArray.splice(h[0],h[1],...g).forEach(T=>{T.forEach(A=>{this.destroyEffect(A)})})}else{const p=u,g=this.collectEffect();this.set(p,e(s.at(p),(c=s.atomIndexes)==null?void 0:c[p]));const v=g();this.effectFramesArray[p].forEach(T=>{this.destroyEffect(T)}),this.effectFramesArray[p]=v}})},r,{onDestroy:i=>{e.length>1&&s.removeAtomIndexesDep()}})}reduce(e){const n=this;return new D(null,function(r){this.manualTrack(n,m.METHOD,d.METHOD),this.manualTrack(n,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),this.data=[];for(let s=0;s<n.data.length;s++){const i=L.collectEffect();e(this,n.data[s],s),this.effectFramesArray[s]=i()}return this.data},function(r,s){s.forEach(i=>{const{method:a,argv:o}=i;S(a==="splice"&&o[0]===n.data.length-o.slice(2).length&&o[1]===0,"reduce can only support append");const c=this.data.length,l=o.slice(2);for(let h=0;h<l.length;h++){const u=L.collectEffect();e(this,l[h],h+c),this.effectFramesArray[h]=u()}})})}find(e){const n=this;let r=-1;return U(function(){return this.manualTrack(n,m.METHOD,d.METHOD),this.manualTrack(n,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),n.data.find((s,i)=>e(s)?(r=i,!0):!1)},function(s,i){i.forEach(a=>{const{method:o,argv:c,key:l}=a;S(!!(o==="splice"||l),"trigger info has no method and key");let h=-1;if(o==="splice"){const u=c[0];r>=u&&(h=u)}else r===l&&(h=l);if(h!==-1){r=-1;for(let u=h;u<n.data.length;u++)if(e(n.data[u])){r=u,s(n.data[u]);return}s(null)}})})}findIndex(e){const n=this;let r=-1;return U(function(){return this.manualTrack(n,m.METHOD,d.METHOD),this.manualTrack(n,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),n.data.findIndex((s,i)=>e(s)?(r=i,!0):!1)},function(s,i){i.forEach(a=>{const{method:o,argv:c,key:l}=a;S(!!(o==="splice"||l),"trigger info has no method and key");let h=-1;if(o==="splice"){const u=c[0];r>=u&&(h=u)}else r===l&&(h=l);if(h!==-1){r=-1;for(let u=h;u<n.data.length;u++)if(e(n.data[u])){r=u,s(r);return}s(r)}})})}filter(e){const n=this;return new D(null,function(){return this.manualTrack(n,m.METHOD,d.METHOD),this.manualTrack(n,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),n.data.filter(e)},function(r,s){s.forEach(i=>{const{method:a,argv:o,key:c,oldValue:l,methodResult:h}=i;if(S(!!(a==="splice"||c),"trigger info has no method and key"),a==="splice")(h||[]).forEach(u=>{this.data.includes(u)&&this.splice(this.data.indexOf(u),1)}),o.slice(2).forEach(u=>{e(u)&&this.push(u)});else{const u=c,p=n.data[u];e(p)&&this.push(p),this.data.includes(l)&&this.splice(this.data.indexOf(l),1)}})})}groupBy(e){const n=this;return new ie(null,function(){const r=new Map;this.manualTrack(n,m.METHOD,d.METHOD),this.manualTrack(n,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE);for(let s=0;s<n.data.length;s++){const i=n.data[s],a=e(i);r.has(a)||r.set(a,new D([])),r.get(a).push(i)}return r},function(r,s){s.forEach(i=>{const{method:a,argv:o,key:c,oldValue:l,newValue:h,methodResult:u}=i;if(S(!!(a==="splice"||c),"trigger info has no method and key"),a==="splice")(u||[]).forEach(p=>{const g=e(p);this.data.has(g)&&this.data.get(g).splice(this.data.get(g).data.indexOf(p),1)}),o.slice(2).forEach(p=>{const g=e(p);this.data.has(g)||this.data.set(g,new D([])),this.data.get(g).push(p)});else{if(l){const g=e(l);this.data.get(g).splice(this.data.get(g).data.indexOf(l),1)}const p=e(h);this.data.has(p)||this.data.set(p,new D([])),this.data.get(p).push(h)}})})}indexBy(e){const n=this;return new ie(null,function(){const r=new Map;this.manualTrack(n,m.METHOD,d.METHOD),this.manualTrack(n,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE);for(let s=0;s<n.data.length;s++){const i=n.data[s],a=typeof e=="function"?e(i):i[e];S(!r.has(a),"indexBy key is already exist"),r.set(a,i)}return r},function(r,s){s.forEach(i=>{const{method:a,argv:o,key:c,oldValue:l,newValue:h,methodResult:u}=i;if(S(!!(a==="splice"||c),"trigger info has no method and key"),a==="splice")(u||[]).forEach(p=>{const g=typeof e=="function"?e(p):p[e];this.data.delete(g)}),o.slice(2).forEach(p=>{const g=typeof e=="function"?e(p):p[e];S(!this.data.has(g),"indexBy key is already exist"),this.data.set(g,p)});else{const p=typeof e=="function"?e(l):l[e];this.data.delete(p);const g=typeof e=="function"?e(h):h[e];this.data.set(g,h)}})})}get length(){const e=this;return U(function(){return this.manualTrack(e,m.METHOD,d.METHOD),e.data.length},function(n,r){n(e.data.length)})}onUntrack(e){}createSelection(e,n=!1){return dn(this,e,n)}}function dn(t,e,n=!1){let r=new Map;return new D(null,function(){this.manualTrack(t,m.METHOD,d.METHOD),this.manualTrack(t,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),O(e)?this.manualTrack(e,m.ATOM,"value"):this.manualTrack(e,m.METHOD,d.METHOD);const s=t.data.map((i,a)=>[i,x(!1)]);return s.forEach(([i,a])=>{r.set(i,a)}),(O(e)?e.raw===null?[]:[e.raw]:e.data).forEach(i=>{var a;if(n)(a=s[i])==null||a[1](!0);else{const o=r.get(i);o==null||o(!0)}}),s},function(s,i){i.forEach(a=>{if(a.source===e){O(e)||S(a.method==="splice","currentValues can only support splice");const o=O(e)?a.oldValue===null?[]:[a.oldValue]:a.methodResult||[],c=O(e)?a.newValue===null?[]:[a.newValue]:a.argv.slice(2);if(n)o.forEach(l=>{const h=this.data[l][1];h(!1)}),c.forEach(l=>{const h=this.data[l][1];h==null||h(!0)});else{debugger;o.forEach(l=>{const h=r==null?void 0:r.get(l);h==null||h(!1)}),c.forEach(l=>{const h=r==null?void 0:r.get(l);h==null||h(!0)})}}if(a.source===t){const{method:o,argv:c,key:l,oldValue:h}=a;if(o==="splice"){const u=c[0],p=c[1],g=c.slice(2).length,v=c.slice(2).map(A=>[A,x(!1)]),T=this.splice(u,p,...v);if(T.forEach(([A,C])=>{r.delete(A)}),v.forEach(([A,C])=>{r.set(A,C)}),n){const A=O(e)?[e.raw]:e.data,C=[];A.forEach((E,y)=>{const w=E;if(w>this.data.length-1)C.push(y);else{if(w>=u&&p!==g){const F=w+g-p;r.get(this.data.at(F)[0])(!1)}const I=this.data.at(w)[1];I==null||I(!0)}}),C.length>0&&(O(e)?e(null):C.forEach((E,y)=>{e.splice(C[0]-y,0)}))}else T.forEach(([A,C])=>{O(e)?e.raw===A&&e(null):e.data.indexOf(A)!==-1&&e.splice(e.data.indexOf(A),1)});return}if(r.delete(h),this.data[l]=[t.data[l],x(!1)],n)O(e)?e.raw===l&&this.data[l][1](!0):e.data.includes(l)&&this.data[l][1](!0);else if(O(e))e.raw===h&&e(null);else{const u=e.data.indexOf(h);u!==-1&&e.splice(u,1)}}})},void 0,{onDestroy:s=>{r=null}})}class pn extends L{constructor(e){super(!0),this.fn=e,this.run()}effectFn(){this.fn()}}function or(t){const e=new pn(t);return()=>{e.destroy()}}function gn(){}function xe(t){const e=typeof t;return e==="string"||e==="number"}function N(t){function e(...n){var r,s,i;function a(o){var c;if(!((c=a.check)!=null&&c.call(a,o)))return new Error("type check failed")}return a.argv=n,a.stringify=(r=t.stringify)==null?void 0:r.bind(a),a.parse=(s=t.parse)==null?void 0:s.bind(a),a.check=(i=t.check)==null?void 0:i.bind(a),a.is=t.is||(o=>o===e),a.zeroValue=t.zeroValue,a.required=t.required,a.createDefaultValue=t.createDefaultValue,a.coerce=t.coerce,a.required||Object.defineProperty(a,"isRequired",{get(){return N({...t,required:!0,is:a.is})(...n)}}),a.createDefaultValue?Object.defineProperty(a,"defaultValue",{get(){if(a.createDefaultValue)return a.createDefaultValue()}}):Object.defineProperty(a,"default",{get(){return o=>N({...t,required:a.required,createDefaultValue:o,is:a.is})(...n)}}),a.valueType={},a}return e}function j(t,e){const{stringify:n=JSON.stringify,parse:r=JSON.parse,is:s,required:i,...a}=e,o=function(c){if(typeof t=="function"&&!t(c))return new Error(`${c} type check failed`);if(typeof t=="string"&&typeof c!==t)return new Error(`${c} is not ${t}`)};return o.stringify=n,o.parse=r,o.check=c=>typeof t=="string"?typeof c===t:t(c),o.is=s||(c=>c===o),o.required=!!i,Object.assign(o,a),o.required||Object.defineProperty(o,"isRequired",{get(){return j(t,{...e,required:!0,is:o.is})}}),o.createDefaultValue?Object.defineProperty(o,"defaultValue",{get(){if(o.createDefaultValue)return o.createDefaultValue()}}):Object.defineProperty(o,"default",{get(){return c=>j(t,{...e,required:o.required,createDefaultValue:c,is:o.is})}}),o.valueType={},o}const mn=N({stringify(t){return t===null?"":xe(this.argv[0][0])?t.toString():JSON.stringify(t)},parse(t){return xe(this.argv[0][0])?typeof this.argv[0][0]=="string"?t:parseFloat(t):JSON.parse(t)},check(t){return this.argv[0].includes(t)},zeroValue:[]}),yn={zeroValue:""},En=j("string",yn),Tn={stringify(t){return t.toString()},parse(t){if(/-?\d+(\.\d+)?/.test(t))return parseFloat(t);throw new Error(`${t} is not a number`)},zeroValue:0},kn=j("number",Tn),vn={zeroValue:null},wn=j(t=>typeof t=="object"&&!Array.isArray(t),vn),Cn=j(t=>Array.isArray(t),{}),An={zeroValue:!1},bn=j("bool",An),Sn={stringify(t){return t.toString()},parse(t){return new Function(t)}},In=j("function",Sn),On=j("symbol",{}),xn={stringify(){throw new Error("type any can not stringify")},parse(){throw new Error("type any can not parse")},check(){throw new Error("type any can not check")}},le=j(()=>!0,xn),Hn=N({check(t){return this.argv[0].some(e=>e.check(t))},stringify(t){return this.argv[0].find(e=>!(e(t)instanceof Error)).stringify(t)},parse(t){let e;if(!this.argv[0].some(n=>{try{const r=n.parse(t);if(this.check(r))return e=r,!0}catch{}return!1}))throw new Error(`can not parse ${t}`);return e}}),Dn=N({check(t){return Array.isArray(t)?t.every(e=>this.argv[0].check(e)):!1},stringify(t){},parse(t){},zeroValue:[]}),Mn=N({check(t){return!0},stringify(t){},parse(t){}}),_n=N({check(t){return Object.entries(this.argv[0]).every(([e,n])=>n.check(t[e]))},stringify(t){return`{${Object.entries(this.argv[0]).map(([e,n])=>`${e}:${JSON.stringify(n.stringify(t[e]))}`).join(",")}`},parse(t){const e=JSON.parse(t);return Object.keys(e).forEach(n=>{e[n]=this.argv[0][n].parse(e[n])}),e}}),Vn=le,Pn=le,Ln=le,Rn=gn;function Nn(){return N({coerce:t=>O(t)?t:x(t)})()}function jn(){return N({coerce:t=>t instanceof D?t:new D(t)})()}function Fn(){return N({coerce:t=>t instanceof ie?t:new ie(t)})()}const Y={string:En,number:kn,object:wn,array:Cn,bool:bn,function:In,symbol:On,node:Vn,element:Pn,elementType:Ln,oneOf:mn,oneOfType:Hn,arrayOf:Dn,shapeOf:Mn,map:_n,any:le,checkPropTypes:Rn,atom:Nn,rxList:jn,rxMap:Fn};function Gn(t,e){const n=t[1]===void 0?t.length<2?1/0:0:t[1],r=n<0?0:n;return r!==1/0?r:e-t[0]}class Kn{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.createHost=([s,i])=>W(s,i,{...this.pathContext,hostPath:[...this.pathContext.hostPath,this]})}createPlaceholder(e){return[e,document.createComment("frag item host")]}isOnlyChildrenOfParent(){const e=this.placeholder.parentElement;return(e==null?void 0:e.lastChild)===this.placeholder&&e.firstChild===this.element}get element(){var e,n;return((n=(e=this.hostsComputed)==null?void 0:e[0])==null?void 0:n.element)||this.placeholder}render(){const e=this;this.placeholderAndItemComputed=P(function(){if(this.manualTrack(e.source,m.METHOD,d.METHOD),this.manualTrack(e.source,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),e.hostsComputed)throw new Error("should never recompute reactiveArray");return e.source.map(e.createPlaceholder)},function(n,r){r.forEach(({method:s,argv:i,result:a})=>{var o,c,l;if(s==="push"){const h=i.map(e.createPlaceholder);n.push(...h)}else if(s==="pop")n.pop();else if(s==="shift")n.shift();else if(s==="unshift"){const h=i.map(e.createPlaceholder);n.unshift(...h)}else if(s==="splice"){const h=i.slice(2).map(e.createPlaceholder);n.splice(i[0],i[1],...h)}else if(!s&&a)(o=a.add)==null||o.forEach(({})=>{throw new Error("can not use obj[key] = value to add item to reactive array, use push instead.")}),(c=a.remove)==null||c.forEach(({})=>{throw new Error("can not use delete obj[key] to delete item, use splice instead.")}),(l=a.update)==null||l.forEach(({key:h,newValue:u})=>{n[h]=e.createPlaceholder(u)});else throw new Error("unknown trigger info")})},function(n){n()}),this.hostsComputed=P(function(){var n;if((n=e.hostsComputed)!=null&&n.length)throw new Error("hostsComputed should not recompute");this.manualTrack(e.placeholderAndItemComputed,m.METHOD,d.METHOD),this.manualTrack(e.placeholderAndItemComputed,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE);const r=e.placeholderAndItemComputed.map(([i,a])=>W(i,a,{...e.pathContext,hostPath:[...e.pathContext.hostPath,e]})),s=document.createDocumentFragment();return r.forEach(i=>{s.appendChild(i.placeholder),i.render()}),V(s,e.placeholder),r},function(n,r){r.forEach(({method:s,argv:i,result:a})=>{var o,c,l,h;if(s==="push"){const u=i.map(e.createHost),p=document.createDocumentFragment();u.forEach(g=>{p.appendChild(g.placeholder),g.render()}),V(p,e.placeholder),n.push(...u)}else if(s==="pop")n.pop().destroy();else if(s==="shift")n.shift().destroy();else if(s==="unshift"){const u=i.map(e.createHost),p=document.createDocumentFragment();u.forEach(g=>{p.appendChild(g.placeholder),g.render()}),V(p,e.element),n.unshift(...u)}else if(s==="splice"){const u=document.createDocumentFragment(),p=i.slice(2).map(e.createHost);if(p.forEach(g=>{u.appendChild(g.placeholder),g.render()}),i[0]===0&&i[1]>=n.length&&e.isOnlyChildrenOfParent()){const g=e.placeholder.parentNode;!p.length&&g instanceof HTMLElement?(g.innerHTML="",g.appendChild(u)):g.replaceChildren(u),g.appendChild(e.placeholder),n.forEach(v=>v.destroy(!0)),n.splice(0,1/0,...p)}else{const g=Gn(i,n.length);V(u,((o=n[i[0]+g])==null?void 0:o.element)||e.placeholder),n.splice(i[0],g,...p).forEach(v=>v.destroy())}}else if(!s&&a)(c=a.add)==null||c.forEach(({})=>{throw new Error("should never occur")}),(l=a.remove)==null||l.forEach(({})=>{throw new Error("should never occur")}),(h=a.update)==null||h.forEach(({key:u,newValue:p})=>{var g;n[u].destroy(),n[u]=e.createHost(p),V(n[u].placeholder,((g=n[parseInt(u,10)+1])==null?void 0:g.element)||e.placeholder),n[u].render()});else throw new Error("unknown trigger info")})},function(n){n()})}destroy(e,n){n||($(this.hostsComputed),$(this.placeholderAndItemComputed)),this.hostsComputed.forEach(r=>r.destroy(e)),e||this.placeholder.remove()}}const He=new WeakSet;function $n({container:t,content:e,destroyOnUnmount:n},{useEffect:r,pathContext:s}){typeof e!="function"&&(He.has(e)&&console.error("static portal content can only be rendered once. Use function content for content has reactive parts."),He.add(e));const i=ir(t,s);return i.render(e),r(()=>()=>{i.destroy()}),null}function Wn(){return{current:null}}function Yn(){const t=x(null);return new Proxy({},{get:(e,n)=>{if(n==="current")return t()},set:(e,n,r)=>(n==="current"&&t(r),!0)})}function ae(t){return t?Array.isArray(t)?t:[t]:[]}function Bn(t,e){return Object.entries(e).forEach(([n,r])=>{const s=t[n];s&&(n.startsWith("on")||n==="ref"||n==="style")?n==="style"?t[n]=ae(s).concat(r):t[n]=ae(r).concat(s):t[n]=r}),t}const Xn="$$config",Ze=class J{constructor({type:e,props:n={},children:r},s,i){this.placeholder=s,this.pathContext=i,this.layoutEffects=new Set,this.effects=new Set,this.destroyCallback=new Set,this.layoutEffectDestroyHandles=new Set,this.refs=X({}),this.itemConfig={},this.frame=[],this.exposed={},this.createHTMLOrSVGElement=(a,o,c,...l)=>{var h,u,p;const g=typeof o=="function";let v="";if(c&&Object.keys(c).some(y=>{if(y==="as")return v=c[y],delete c[y],!0}),v&&(h=this.itemConfig[v])!=null&&h.use&&((u=this.itemConfig[v])==null?void 0:u.use)instanceof Element)return this.itemConfig[v].use;let T=c,A=l;if(v&&this.itemConfig[v]){const y=this.itemConfig[v];y.props&&(g?T={...c,...y.props}:T=Bn(c,y.props)),y.propMergeHandles&&Object.entries(y.propMergeHandles).forEach(([w,I])=>{T[w]=I(T[w])}),y.propsMergeHandle&&(T=y.propsMergeHandle(T)),y.children&&(A=y.children),y.config&&g&&(T={...T,...y.config})}const C=((p=this.itemConfig[v])==null?void 0:p.use)||o;if(!g&&typeof C=="function"){const y=Object.keys(T||{}),w={};y.forEach(I=>{I.startsWith("prop:")?T[I.slice(5)]=T[I]:w[I]=T[I],delete T[I]}),T[qn]=w}v&&g&&(T.ref=ae(T.ref).concat(y=>this.refs[v]=y));const E=a?dt(C,T,...A):M(C,T,...A);return v&&!g&&(this.refs[v]=E),E},this.createElement=this.createHTMLOrSVGElement.bind(this,!1),this.createSVGElement=this.createHTMLOrSVGElement.bind(this,!0),this.createPortal=(a,o)=>M($n,{container:o,content:a}),this.useLayoutEffect=a=>{this.layoutEffects.add(a)},this.useEffect=a=>{this.effects.add(a)},this.createRef=Wn,this.createRxRef=Yn,this.cleanupsOfExternalTarget=new Set,this.createStateFromRef=(a,o,c)=>{let l;const h=p=>{c&&l&&this.cleanupsOfExternalTarget.delete(l),l==null||l(),p!==null?(l=a(p,u,o),c&&l&&this.cleanupsOfExternalTarget.add(l)):(l=void 0,u(null))},u=new Proxy(x(null),{get:(p,g)=>g==="ref"?h:p[g]});return c&&u.ref(c),u},this.expose=(a,o)=>(typeof a=="object"&&o===void 0?Object.assign(this.exposed,a):typeof o=="string"&&(this.exposed[o]=a),a),this.onCleanup=a=>{this.destroyCallback.add(a)},this.runLayoutEffect=()=>{this.layoutEffects.forEach(a=>{const o=a();typeof o=="function"&&this.layoutEffectDestroyHandles.add(o)})},J.typeIds.has(e)||J.typeIds.set(e,J.typeIds.size),this.name=e.name,this.type=e,this.props={},Object.entries(n).forEach(([a,o])=>{if(a===Xn)this.itemConfig=o;else if(a[0]==="$"){const[c,l]=a.slice(1).split(":");this.itemConfig[c]||(this.itemConfig[c]={}),l==="_eventTarget"?this.itemConfig[c].eventTarget=ae(o):l==="_use"?this.itemConfig[c].use=o:l==="_props"?this.itemConfig[c].propsMergeHandle=o:l==="_children"?this.itemConfig[c].children=o:l===void 0||l===""?this.itemConfig[c].config=o:(l==null?void 0:l[0])==="_"?K(!1,`unsupported config item: ${c}`):l.endsWith("_")?(this.itemConfig[c].propMergeHandles||(this.itemConfig[c].propMergeHandles={}),this.itemConfig[c].propMergeHandles[l.slice(0,-1)]=o):(this.itemConfig[c].props||(this.itemConfig[c].props={}),this.itemConfig[c].props[l]=o)}else this.props[a]=o}),this.children=r,this.deleteLayoutEffectCallback=i.root.on("attach",this.runLayoutEffect)}get typeId(){return J.typeIds.get(this.type)}get parentElement(){return this.placeholder.parentElement}get element(){var e;return((e=this.innerHost)==null?void 0:e.element)||this.placeholder}handleProps(e,n){const r={};return Object.entries(e).forEach(([s,i])=>{var a;n[s]!==void 0?r[s]=((a=i.coerce)==null?void 0:a.call(i,n[s]))||n[s]:r[s]=i.defaultValue}),r}attachRef(e){const n={...this.exposed,refs:this.refs};typeof e=="function"?e(n):e.current=n}attachThis(e){typeof e=="function"?e(this):e.current=this}detachRef(e){typeof e=="function"?e(null):e.current=null}render(){this.element!==this.placeholder&&K(!1,"should never rerender"),this.renderContext={Fragment:Ne,createElement:this.createElement,createSVGElement:this.createSVGElement,refs:this.refs,useLayoutEffect:this.useLayoutEffect,useEffect:this.useEffect,pathContext:this.pathContext,context:new zn(this.pathContext.hostPath),createPortal:this.createPortal,createRef:this.createRef,createRxRef:this.createRxRef,createStateFromRef:this.createStateFromRef,onCleanup:this.onCleanup,expose:this.expose};const{ref:e,...n}=this.props,r=L.collectEffect(),s={...this.type.propTypes?this.handleProps(this.type.propTypes,n):n,children:this.children},i=this.type(s,this.renderContext);this.frame=r(),this.innerHost=W(i,this.placeholder,{...this.pathContext,hostPath:[...this.pathContext.hostPath,this]}),this.innerHost.render(),this.props.ref&&this.attachRef(this.props.ref),this.props.__this&&this.attachThis(this.props.__this),this.effects.forEach(a=>{const o=a();typeof o=="function"&&this.destroyCallback.add(o)})}destroy(e,n){var r;this.props.ref&&this.detachRef(this.props.ref),n||(r=this.frame)==null||r.forEach(s=>s.destroy()),this.innerHost.destroy(e,n),this.layoutEffectDestroyHandles.forEach(s=>s()),this.destroyCallback.forEach(s=>s()),this.cleanupsOfExternalTarget.forEach(s=>s()),this.cleanupsOfExternalTarget.clear(),e||this.placeholder.remove(),this.deleteLayoutEffectCallback()}};Ze.typeIds=new Map;let ve=Ze;class zn{constructor(e){this.hostPath=e,this.valueByType=new Map}get(e){for(let n=this.hostPath.length-1;n>=0;n--){const r=this.hostPath[n];if(r instanceof ve&&r.renderContext.context.valueByType.has(e))return r.renderContext.context.valueByType.get(e)}}set(e,n){this.valueByType.set(e,n)}}const qn="__nativeAttrs";function De(t){return t!=null&&t.toString?t.toString():t===void 0?"undefined":JSON.stringify(t)}class Jn{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.element=this.placeholder}get parentElement(){return this.placeholder.parentNode||this.element.parentElement}replace(e){if(this.element===this.placeholder){const n=document.createTextNode(De(e));this.parentElement.replaceChild(n,this.placeholder),this.element=n}else this.element.nodeValue=De(e)}render(){this.computed=P(()=>{this.replace(this.source())},void 0,void 0,void 0,this.pathContext.skipIndicator)}destroy(e,n){n||$(this.computed),e||(this.element.remove(),this.placeholder.remove())}}class Un{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.fragmentParent=document.createDocumentFragment()}get parentElement(){return this.placeholder.parentElement||this.fragmentParent}get element(){var e;return((e=this.innerHost)==null?void 0:e.call(this).element)||this.placeholder}render(){this.innerHost=U(()=>{const n=this.source(),r=document.createComment("computed node");return V(r,this.placeholder),W(n,r,{...this.pathContext,hostPath:[...this.pathContext.hostPath,this]})});let e;this.renderComputed=P(()=>{e&&e.destroy(!1,!1),e=this.innerHost(),f.instance.pauseTracking(),e.render(),f.instance.resetTracking()})}destroy(e,n){const r=this.innerHost();n||($(this.renderComputed),$(this.innerHost)),r==null||r.destroy(e,!n),e||this.placeholder.remove()}}const Zn=M.isValidAttribute;M.isValidAttribute=function(t,e){return t.startsWith("on")?!0:Array.isArray(e)&&e.some(Me)||Me(e)?!1:Zn(t,e)};function Me(t){return ke(t)||O(t)||typeof t=="function"}function _e(t){return O(t)||typeof t=="function"}function Qe(t){return Array.isArray(t)?t.some(Qe):Object.entries(t).some(([e,n])=>e.startsWith(":")||typeof n=="object"&&n!==null)}class Qn{constructor(){this.styleScripts=new Map,this.elToStyleId=new WeakMap}getStyleSheetId(e,n,r){if(r){const o=this.elToStyleId.get(r);if(o)return o;{const c=`gen-${Math.random().toString(36).slice(2)}`;return this.elToStyleId.set(r,c),c}}const s=e.findLastIndex(o=>o instanceof ve),i=s===-1?void 0:e[s],a=s===-1?e:e.slice(s+1);return`gen-${(i==null?void 0:i.typeId)??"global"}-${a.map(o=>o.pathContext.elementPath.join("_")).join("-")}-${n.join("_")}`}stringifyStyleObject(e){return Object.entries(e).map(([n,r])=>{const s=n.replace(/([A-Z])/g,"-$1").toLowerCase();return typeof r=="number"&&Re.test(n)?`${s}:${r}px;`:`${s}:${r};`}).join(`
`)}update(e,n,r,s,i=!1){const a=this.getStyleSheetId(e,n,i?null:s);let o=this.styleScripts.get(a);o||(o=document.createElement("style"),document.head.appendChild(o),this.styleScripts.set(a,o)),o.innerHTML=this.generateStyleContent(`.${a}`,r),s.classList.add(a)}generateStyleContent(e,n){const r=Object.keys(n).filter(c=>typeof n[c]!="object"),s=Object.keys(n).filter(c=>typeof n[c]=="object"),i=Object.fromEntries(r.map(c=>[c,n[c]])),a=`${e} {
${this.stringifyStyleObject(i)}
}
`,o=s.map(c=>{if(c.startsWith("@"))return`${c} {
    ${this.generateStyleContent(e,n[c])}
}`;const l=/^(\s?)+&/.test(c)?c.replace("&",e):`${e} ${c}`;return this.generateStyleContent(l,n[c])}).join(`
`);return a+o}}function et(t){return Array.isArray(t)?t.every(et):typeof t=="object"}const tt=class nt{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.computed=void 0,this.element=this.placeholder}get parentElement(){return this.placeholder.parentElement}render(){K(this.element===this.placeholder,"should never rerender"),this.element=this.source instanceof DocumentFragment?document.createComment("fragment start"):this.source,V(this.source,this.placeholder),this.collectInnerHost(),this.collectReactiveAttr(),this.collectReactiveAttr(),this.collectRefHandles(),this.reactiveHosts.forEach(e=>e.render())}collectInnerHost(){const e=this.source;if(!(e instanceof HTMLElement||e instanceof DocumentFragment||e instanceof SVGElement))return;const{unhandledChildren:n}=e;this.reactiveHosts=n?n.map(({placeholder:r,child:s,path:i})=>W(s,r,{...this.pathContext,hostPath:[...this.pathContext.hostPath,this],elementPath:i})):[]}collectReactiveAttr(){const e=this.source;if(!(e instanceof HTMLElement||e instanceof DocumentFragment||e instanceof SVGElement))return;const n=e instanceof SVGElement,{unhandledAttr:r}=e;this.attrComputeds=[],r==null||r.forEach(({el:s,key:i,value:a,path:o})=>{this.attrComputeds.push(P(()=>{const c=Array.isArray(a)?a.map(l=>_e(l)?l():l):_e(a)?a():a;if(i==="style"&&Qe(c)){const l=et(a),h=Array.isArray(c)?Object.assign({},...c):c;nt.styleManager.update(this.pathContext.hostPath,o,h,s,l)}else pe(s,i,c,n)}))})}collectRefHandles(){const e=this.source;if(!(e instanceof HTMLElement||e instanceof DocumentFragment||e instanceof SVGElement))return;const{refHandles:n}=e;this.refHandles=n}destroy(e,n){var r,s,i;n||(r=this.attrComputeds)==null||r.forEach(a=>$(a)),(s=this.reactiveHosts)==null||s.forEach(a=>a.destroy(!0,n)),(i=this.refHandles)==null||i.forEach(({handle:a})=>{M.detachRef(a)}),e||Pe(this.element,this.placeholder,!0)}};tt.styleManager=new Qn;let er=tt;class tr{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.computed=void 0,this.childHosts=[]}get parentElement(){return this.placeholder.parentElement}get element(){var e;return((e=this.firstChild)==null?void 0:e.element)||this.firstChild||this.placeholder}render(){if(this.element===this.placeholder){const e=document.createDocumentFragment();this.source.forEach((n,r)=>{if(typeof n=="string"||typeof n=="number"){const s=document.createTextNode(n.toString());e.appendChild(s),r===0&&(this.firstChild=s)}else if(n instanceof Text)e.appendChild(n),r===0&&(this.firstChild=n);else{const s=document.createComment("array item");e.appendChild(s);const i=W(n,s,{...this.pathContext,hostPath:[...this.pathContext.hostPath,this]});this.childHosts.push(i),r===0&&(this.firstChild=i)}}),this.childHosts.forEach(n=>n.render()),V(e,this.placeholder)}else throw new Error("should never rerender")}destroy(e,n){e||(Pe(this.element,this.placeholder,!0),this.childHosts.forEach(r=>r.destroy(!0,n)))}}class nr{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r}createPlaceholder(e){return[e,document.createComment("frag item host")]}isOnlyChildrenOfParent(){const e=this.placeholder.parentElement;return(e==null?void 0:e.lastChild)===this.placeholder&&e.firstChild===this.element}get element(){var e,n;return((n=(e=this.hosts)==null?void 0:e.at(0))==null?void 0:n.element)||this.placeholder}renderNewHosts(e){const n=document.createDocumentFragment();return e.forEach(r=>{n.appendChild(r.placeholder),r.render()}),n}render(){const e=this;this.hosts=this.source.map(n=>W(n,document.createComment("rx list item"),{...this.pathContext,hostPath:[...this.pathContext.hostPath,this]}),({method:n,argv:r,result:s,key:i,newValue:a})=>{if(n==="splice"){const o=this.hosts.data.slice(r[0],r[0]+r[1]),c=this.isOnlyChildrenOfParent();if(o.length===this.hosts.length()&&c){const l=this.placeholder.parentNode;l instanceof HTMLElement&&(l.innerHTML=""),l.appendChild(this.placeholder),o.forEach(h=>h.destroy(!0))}else o.forEach(l=>l.destroy())}else if(i)this.hosts.at(i).destroy();else throw new Error("unknown trigger info")}),this.hostRenderComputed=P(function(){return this.manualTrack(e.hosts,m.METHOD,d.METHOD),this.manualTrack(e.hosts,m.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),V(e.renderNewHosts(e.hosts),e.placeholder),null},function(n,r){r.forEach(({method:s,argv:i,result:a,key:o,newValue:c})=>{var l;if(s==="splice"){const h=e.hosts.at(i[0]+i.slice(2).length),u=i.slice(2),p=e.renderNewHosts(u);V(p,(h==null?void 0:h.element)||e.placeholder)}else if(!s&&o){const h=o;V(e.hosts.at(h).placeholder,((l=e.hosts.at(h+1))==null?void 0:l.element)||e.placeholder),e.hosts.at(h).render()}else throw new Error("unknown trigger info")})})}destroy(e,n){var r;n||((r=this.hosts)==null||r.destroy(),$(this.hostRenderComputed)),this.hosts.forEach(s=>s.destroy(e)),e||this.placeholder.remove()}}class rr{constructor(e){this.pathContext=e,this.element=document.createComment("empty"),this.placeholder=this.element}render(){}destroy(e){e||this.placeholder.remove()}}class sr{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.element=this.placeholder}render(){this.element=document.createTextNode(this.source.toString()),V(this.element,this.placeholder)}destroy(e){e||this.placeholder.remove(),this.element.remove()}}function W(t,e,n){if(!(e instanceof Comment))throw new Error("incorrect placeholder type");let r;return t instanceof D?r=new nr(t,e,n):Array.isArray(t)?ke(t)?r=new Kn(t,e,n):r=new tr(t,e,n):typeof t=="object"&&typeof(t==null?void 0:t.type)=="function"?r=new ve(t,e,n):O(t)?r=new Jn(t,e,n):typeof t=="function"?r=new Un(t,e,n):t instanceof HTMLElement||t instanceof SVGElement||t instanceof DocumentFragment?r=new er(t,e,n):t==null?r=new rr(n):typeof t=="string"||typeof t=="number"||typeof t=="boolean"?r=new sr(t,e,n):K(!1,`unknown child type ${t}`),r}function ir(t,e){const n=new Map,r=e||{hostPath:[],elementPath:[]},s={element:t,pathContext:r,host:void 0,render(i){const a=document.createComment("root");return t.appendChild(a),s.host=W(i,a,r),s.host.render(),document.body.contains(t)&&s.dispatch("attach"),s.host},destroy(){var i;n.clear(),s.dispatch("detach"),(i=s.host)==null||i.destroy()},on(i,a){let o=n.get(i);return o||n.set(i,o=new Set),o.add(a),()=>{o.delete(a)}},dispatch(i,a){var o;(o=n.get(i))==null||o.forEach(c=>c(a))}};return r.root=s,s}function rt(t){return e=>n=>{if(t(n))return e(n)}}const cr=rt(t=>t.key==="Enter"),lr=rt(t=>t.button===0);function hr(t){return e=>{e.stopPropagation(),t(e)}}Y.string.isRequired,Y.rxMap(),Y.any.isRequired,Y.function,Y.function,Y.function,Y.function;const ur=Symbol("ModalContext");function fr(t,e,n){if(t===window){(()=>{const i={right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight};return te(i,e())||e(i),i})();return}const r=t,s=()=>{const i=r.getBoundingClientRect(),a={top:i.top,left:i.left,right:i.right,bottom:i.bottom};return te(a,e())||e(a),a};if(Array.isArray(n)){const i=[];return n.forEach(a=>{const o=()=>s();a.target.addEventListener(a.event,o),i.push(()=>a.target.removeEventListener(a.event,o))}),()=>{i.forEach(a=>a())}}else if(n==="requestAnimationFrame"){const i=window.requestAnimationFrame(s);return()=>{window.cancelAnimationFrame(i)}}else if(n==="requestIdleCallback"){const i=window.requestIdleCallback(s);return()=>{window.cancelIdleCallback(i)}}else if(n.type==="interval"){const i=window.setInterval(s,n.duration||1e3);return()=>{window.clearInterval(i)}}else K(!1,"invalid options.position")}const fe=new WeakMap,Ve=new ResizeObserver(t=>{t.forEach(e=>{const n=e.target,r=fe.get(n);if(r){const s={width:e.contentRect.width,height:e.contentRect.height,borderBoxWidth:e.borderBoxSize[0].inlineSize,borderBoxHeight:e.borderBoxSize[0].blockSize,contentBoxWidth:e.contentBoxSize[0].inlineSize,contentBoxHeight:e.contentBoxSize[0].blockSize};te(s,r())||r(s)}})});function dr(t,e){if(t===window){const n=()=>{const r={width:window.innerWidth,height:window.innerHeight};return te(r,e())||e(r),r};return window.addEventListener("resize",n),n(),()=>{e(null),window.removeEventListener("resize",n)}}else{Ve.observe(t),fe.set(t,e);const n=t.getBoundingClientRect();return e({width:n.width,height:n.height}),()=>{Ve.unobserve(t),fe.delete(t),e(null)}}}function pr(t,e){const n=()=>{e(!0)},r=()=>{e(!1)};return t.addEventListener("focusin",n),t.addEventListener("focusout",r),()=>{t.removeEventListener("focusin",n),t.removeEventListener("focusout",r)}}const gr={primaryBlue:"#2F51FF",inputBg:"#15181F",innerBorder:"#2A2C33",panelBorder:"#C5C5C5",panelBg:"#1E1F24",itemBg:"#34394E",description:"#C5C5C5",line:"#A6A6A6"},de={small:8,medium:12,large:16,extra:24,ultra:32},ar={gradientBg:{background:"linear-gradient(to bottom right, #7A04F0, #1F43FE)"},formItem:{"$labelContainer:style":{fontSize:14,marginBottom:de.medium},"$labelRequired:style":{color:"red",marginLeft:4}}};function mr({children:t,primary:e},{createElement:n}){const r={background:e?ar.gradientBg.background:"#2A2C33",outline:"none",color:"white",border:e?"none":"1px solid #545863",borderRadius:4,padding:`${de.small}px ${de.extra}px`,fontSize:14,cursor:"pointer",userSelect:"none"};return n("button",{as:"main",style:r},t)}export{Y as B,lr as F,or as H,fr as J,D as P,pr as Q,M as R,ur as U,dr as Z,cr as _,mr as a,ir as b,gr as c,de as g,ie as o,dn as p,ar as s,x,hr as z};
