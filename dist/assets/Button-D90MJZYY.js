(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function ct(t,e){for(let n in t)e(t[n],n)}function Ne(t,e,n=!1){if(t.parentElement!==e.parentElement)throw new Error("placeholder and element parentElement not same");let r=t;for(;r!==e;){const s=r;if(r=s.nextSibling,!r)throw new Error("can not find nextSibling");s.remove()}n&&e.remove()}const je=t=>(t==null?void 0:t.constructor)===Object;function j(t,e){if(!t)throw new Error(e)}function re(t,e){if(t===e)return!0;if(typeof t!="object"||typeof e!="object"||t===null||e===null)return!1;const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(let s of n)if(t[s]!==e[s])return!1;return!0}const Fe=/^(width|height|top|left|right|bottom|margin|padding|border|fontSize|maxWidth|maxHeight|minHeight|minWidth|gap)/;function lt(t,e,n){try{t[e]=n}catch(r){console.error(r)}}function ht(t){const e=this._listeners[t.type];return Array.isArray(e)?e.forEach(n=>n==null?void 0:n(t)):e==null?void 0:e(t)}function ut(t){const e=this._captureListeners[t.type];return Array.isArray(e)?e.forEach(n=>n==null?void 0:n(t)):e==null?void 0:e(t)}const fe=new WeakMap;function ft(t){return t[0]==="o"&&t[1]==="n"}function ye(t,e,n,r){if(Array.isArray(n)&&e!=="style"&&e!=="className"&&!ft(e))return ye(t,e,n.at(-1),r);if(e==="uuid"){t.setAttribute("data-uuid",n);return}if(e[0]==="o"&&e[1]==="n"){const s=e!==(e=e.replace(/Capture$/,""));let i=e.toLowerCase().substring(2);i==="change"&&(i="input");const a=s?ut:ht;n?t.addEventListener(i,a,s):t.removeEventListener(i,a,s);const o=s?t._captureListeners||(t._captureListeners={}):t._listeners||(t._listeners={});j((o==null?void 0:o[i])===void 0,`${e} already listened`),o[i]=n;return}if(e==="style"){(!n||Array.isArray(n)&&!n.length)&&(t.style.cssText=n||""),(Array.isArray(n)?n:[n]).forEach(s=>{typeof s=="string"?t.style.cssText=s:typeof s=="object"?ct(s,(i,a)=>{i===void 0?t.style[a]="":t.style[a]=typeof i=="number"&&Fe.test(a)?`${i}px`:i}):j(!1,"style can only be string or object.")});return}if(e==="className"){const s=Array.isArray(n)?n:[n];let i="";s.forEach(a=>{typeof a=="object"?Object.entries(a).forEach(([o,c])=>{c&&(i=`${i} ${o}`)}):typeof a=="string"?i=`${i} ${a}`:j(!1,"className can only be string or {[k:string]:boolean}")}),t.setAttribute("class",i);return}if(!(e==="key"||e==="ref"))if(e==="class"&&!r)t.className=n||"";else if(e==="value")t.value=n,t.tagName==="SELECT"?fe.set(t,n):t.tagName==="OPTION"?Ke(t):t.tagName==="INPUT"&&t.type==="checkbox"?n?t.setAttribute("checked","true"):t.removeAttribute("checked"):t.tagName==="INPUT"&&t.type==="text"&&n===void 0&&(t.value="");else if(e==="checked"&&t.tagName==="INPUT"&&t.type==="checkbox")n?t.setAttribute("checked","true"):t.removeAttribute("checked");else if(e==="disabled")n?t.setAttribute("disabled","true"):t.removeAttribute("disabled");else if(e==="dangerouslySetInnerHTML")n&&(t.innerHTML=n||"");else if(e!=="list"&&e!=="type"&&!r&&e in t)lt(t,e,n===null?"":n),n==null&&t.removeAttribute(e);else{const s=r&&e!==(e=e.replace(/^xlink\:?/,""));n==null||n===!1?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):e.toLowerCase()==="contenteditable"&&n===!1?t.setAttribute(e,"false"):t.removeAttribute(e):typeof n!="function"&&s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),n):t.setAttribute(e,n)}}function V(t,e,...n){const{_isSVG:r,...s}=e||{};let i;const a=n.length?n:s.children||[];if(t===Ge)i=document.createDocumentFragment();else if(typeof t=="string")i=r?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t);else return{type:t,props:s,children:a};const o=[],c=[],l=[];a==null||a.forEach((u,p)=>{if(u!=null)if(typeof u=="string"||typeof u=="number")i.appendChild(document.createTextNode(u.toString()));else if(u instanceof HTMLElement||u instanceof DocumentFragment||u instanceof SVGElement){i.appendChild(u);const g=u,I=g.unhandledChildren||[];c.push(...I.map(k=>({...k,path:[p,...k.path]})));const C=g.unhandledAttr||[];o.push(...C.map(k=>({...k,path:[p,...k.path]})));const A=g.refHandles||[];l.push(...A.map(k=>({...k,path:[p,...k.path]}))),delete g.unhandledChildren,delete g.unhandledAttr,delete g.refHandles}else{const g=document.createComment("unhandledChild");i.appendChild(g),c.push({placeholder:g,child:u,path:[p]})}}),s&&(s.ref&&(l.push({handle:s.ref,path:[],el:i}),delete s.ref),Object.entries(s).forEach(([u,p])=>{V.isValidAttribute(u,p)?ye(i,u,p,r):o.push({el:i,key:u,value:p,path:[]})}));const h=i;return c.length&&(h.unhandledChildren=c),o&&(h.unhandledAttr=o),l.length&&(h.refHandles=l),i}function dt(t){return je(t)&&Object.entries(t).every(([e,n])=>/[a-zA-Z\-]+/.test(e)&&typeof n=="string"||typeof n=="number")}V.isValidAttribute=function(t,e){return Array.isArray(e)?e.every(n=>V.isValidAttribute(t,n)):!!(typeof e!="object"&&typeof e!="function"||t[0]==="o"&&t[1]==="n"&&typeof e=="function"||(dt(e)||typeof e=="string")&&t==="style"||je(e)&&t==="className")};V.attachRef=function(t,e){if(Array.isArray(e)){e.forEach(n=>V.attachRef(t,n));return}typeof e=="function"?e(t):typeof e=="object"?e.current=t:j(!1,"ref should be function or object with current property")};V.detachRef=function(t){if(Array.isArray(t)){t.forEach(e=>V.detachRef(e));return}typeof t=="function"?t(null):typeof t=="object"&&t.hasOwnProperty("current")&&(t.current=null)};function Ge(){}function Ke(t){const e=t.parentElement;fe.has(e)&&(e.value=fe.get(e))}function _(t,e){const n=e.parentNode.insertBefore(t,e);return t.tagName==="OPTION"&&Ke(t),n}function pt(t,e,...n){return V(t,{_isSVG:!0,...e||{}},n)}function gt(t,e){const n=Object.create(null),r=t.split(",");for(let s=0;s<r.length;s++)n[r[s]]=!0;return e?s=>!!n[s.toLowerCase()]:s=>!!n[s]}const yt=Object.getOwnPropertyNames(Array.prototype),mt=new Set(yt.filter(t=>typeof Array.prototype[t]=="function")),Et=t=>mt.has(t),Tt=Object.prototype.hasOwnProperty,le=(t,e)=>Tt.call(t,e),N=Array.isArray,me=t=>ke(t)==="[object Map]",kt=t=>ke(t)==="[object Set]",Ee=t=>typeof t=="string",Te=t=>typeof t=="symbol",vt=t=>t!==null&&typeof t=="object",wt=Object.prototype.toString,ke=t=>wt.call(t),Ct=t=>ke(t).slice(8,-1),ee=t=>(t==null?void 0:t.constructor)===Object||(t==null?void 0:t.constructor)===Array,At=t=>Ee(t)&&(t[0]==="0"||t[0]==="1"||t[0]==="2"||t[0]==="3"||t[0]==="4"||t[0]==="5"||t[0]==="6"||t[0]==="7"||t[0]==="8"||t[0]==="9"),ve=t=>Ee(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,$e=(t,e)=>!Object.is(t,e),te=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},bt=t=>{const e=Ee(t)?Number(t):NaN;return isNaN(e)?t:e};function Ae(t){return typeof t=="string"||typeof t=="number"}function We(t){return ee(t)||N(t)||me(t)||kt(t)}function b(t,e){if(!t)throw new Error(e)}var w=(t=>(t.SKIP="__v_skip",t.IS_REACTIVE="__v_isReactive",t.IS_ATOM="__v_isAtom",t.IS_READONLY="__v_isReadonly",t.IS_SHALLOW="__v_isShallow",t.RAW="__v_raw",t))(w||{});const be=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Be=t=>(t.w&f.trackOpBit)>0,Ye=t=>(t.n&f.trackOpBit)>0,St=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=f.trackOpBit},It=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const s=e[r];Be(s)&&!Ye(s)?s.delete(t):e[n++]=s,s.w&=~f.trackOpBit,s.n&=~f.trackOpBit}e.length=n}};var y=(t=>(t.ATOM="atom",t.GET="get",t.HAS="has",t.ITERATE="iterate",t.METHOD="method",t.EXPLICIT_KEY_CHANGE="explicit_key_change",t))(y||{}),d=(t=>(t.ATOM="atom",t.SET="set",t.ADD="add",t.DELETE="delete",t.CLEAR="clear",t.METHOD="method",t.EXPLICIT_KEY_CHANGE="explicit_key_change",t))(d||{});const Ot=new WeakSet,Xe=new WeakMap;function xt(t){return new Proxy({},{get(e,n){const r=function(...i){return se(i[0],n),t(...i)},s=ze(t);return r.debug=function(...i){return se(i[0],n),s(...i)},r}})}function Ht(t){return new Proxy({},{get(e,n){return function(...r){return se(r[0],n),t(...r)}}})}function ze(t){return function(...e){return Ot.add(e[0]),t(...e)}}function Dt(t){return Xe.get(t)}function se(t,e){return Xe.set(t,e)}function x(t,e,n){let r=t;function s(l){if(arguments.length===0)return f.instance.track(c,y.ATOM,"value"),r;if(r===l)return;const h=r;r=l,f.instance.trigger(c,d.ATOM,{key:"value",newValue:l,oldValue:h})}const i={get(l,h){return h==="raw"?r:h===w.IS_ATOM?!0:(ee(r)&&f.instance.track(c,y.ATOM,"value"),Reflect.get(ee(r)?r:a,h))},set(l,h,u){return typeof r=="object"?Reflect.set(r,h,u):!1},getPrototypeOf(){return r&&typeof r=="object"?Reflect.getPrototypeOf(r):null}},[a,o]=e?e(s,i):[s,i];Object.assign(a,{[Symbol.toPrimitive](l){return f.instance.track(c,y.ATOM,"value"),(!l||l==="default")&&Ae(r)||l==="number"&&typeof r=="number"?r:l==="string"?Ae(r)?r.toString():Object.prototype.toString.call(r):null}}),n&&se(a,n),te(a,w.IS_ATOM,!0);const c=new Proxy(a,o);return c}x.as=new Proxy({},{get(t,e){return(n,r)=>x(n,r,e)}});function O(t){return!!(t&&t.__v_isAtom)}const qe=class J{static collectEffect(){const e=[];return J.collectFrames.push(e),()=>(b(J.collectFrames.at(-1)===e,"collect effect frame error"),J.collectFrames.pop())}constructor(){const e=J.collectFrames.at(-1);e&&e.push(this)}destroy(){}};qe.collectFrames=[];let Mt=qe;const Je=class K extends Mt{constructor(e){super(),this.active=e,this.deps=[],this.children=[],this.index=0,e&&K.activeScopes.length&&(this.parent=K.activeScopes.at(-1),this.parent.children.push(this),this.index=this.parent.children.length-1)}static destroy(e,n){var r;if(e.active){if(e.cleanup(),e.active=!1,e.parent&&!n){const s=e.parent.children.pop();s!==e&&(e.parent.children[e.index]=s,s.index=e.index)}delete e.parent,e.children.forEach(s=>{K.destroy(s,!0)}),e.children=[],(r=e.onDestroy)==null||r.call(e,e)}}effectFn(){}run(...e){if(!this.active)return this.effectFn();if(K.activeScopes.includes(this))throw new Error("recursive effect call");try{return f.trackOpBit=1<<++f.instance.effectTrackDepth,K.activeScopes.push(this),f.instance.enableTracking(),f.instance.effectTrackDepth<=de?St(this):this.cleanup(),this.children.forEach(n=>K.destroy(n,!0)),this.children=[],this.effectFn()}finally{f.instance.effectTrackDepth<=de&&It(this),f.instance.resetTracking(),K.activeScopes.pop(),f.trackOpBit=1<<--f.instance.effectTrackDepth}}cleanup(){const{deps:e}=this;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(this);e.length=0}}destroy(){K.destroy(this)}};Je.activeScopes=[];let L=Je;function Vt(t,e){if(Array.isArray(t))t.splice(0,1/0,...e);else if(ee(t)){const n=Object.keys(e);Object.keys(t).filter(r=>!n.includes(r)).forEach(r=>delete t[r]),Object.assign(t,e)}else if(t instanceof Map){for(const n of t.keys())e.has(n)?t.set(n,e.get(n)):t.delete(n);for(const n of e.keys())t.has(n)||t.set(n,e.get(n))}else t instanceof Set?(t.forEach(n=>{e.has(n)||t.delete(n)}),e.forEach(n=>{t.has(n)||t.add(n)})):b(!1,"unknown source type to replace data")}const Ue=new WeakMap;function $(t){const e=Ue.get(t);L.destroy(e)}class he extends L{constructor(e,n,r,s,i,a,o){if(super(!!e),this.getter=e,this.applyPatch=n,this.callbacks=s,this.skipIndicator=i,this.forceAtom=a,this.keepRaw=o,this.isDirty=!1,this.immediate=!1,this.recomputing=!1,this.triggerInfos=[],this.effectFramesArray=[],this.keyToEffectFrames=new WeakMap,this.recompute=(l=!1)=>{var h,u;if(!(!this.isDirty&&!l)){if((u=(h=this.callbacks)==null?void 0:h.onRecompute)==null||u.call(h,this.data),l||!this.applyPatch){const p=super.run();this.replaceData(p)}else f.instance.pauseTracking(),this.applyPatch.call(this,this.data,this.triggerInfos),f.instance.resetTracking(),this.triggerInfos.length=0;this.isDirty=!1}},this.manualTrack=(l,h,u)=>{f.instance.enableTracking();const p=f.instance.track(O(l)?l:T(l),h,u);return f.instance.resetTracking(),p},this.collectEffect=L.collectEffect,this.destroyEffect=L.destroy,!e)return;typeof r=="function"?this.scheduleRecompute=r:this.immediate=!0,s!=null&&s.onDestroy&&(this.onDestroy=s.onDestroy),s!=null&&s.onTrack&&(this.onTrack=s.onTrack);const c=super.run();this.data=this.keepRaw?c:this.forceAtom?x(c):We(c)?q(c):x(c),this.keepRaw||Ue.set(this.data,this)}get debugName(){return Dt(this.data)}effectFn(){if(this.applyPatch){f.instance.pauseTracking();const e=this.getter.call(this);return f.instance.resetTracking(),e}else return this.getter.call(this)}run(e){var n;(n=this.skipIndicator)!=null&&n.skip||(this.triggerInfos.push(...e),this.isDirty=!0,this.immediate?this.recompute():this.scheduleRecompute(this.recompute))}replaceData(e){O(this.data)?(Se.get(this.data.raw)&&Se.get(this.data.raw)(this.data.raw),this.data(e)):Vt(this.data,e)}}function R(t,e,n,r,s,i){return new he(t,e,n,r,s,i).data}function Q(t,e,n,r,s){return new he(t,e,n,r,s,!0).data}R.as=xt(R);R.debug=ze(R);const Se=new WeakMap,H=Symbol("iterate"),ie=Symbol("Map key iterate"),de=30,Ze=class U{constructor(){this.targetMap=new WeakMap,this.arrayExplicitKeyDepCount=new WeakMap,this.shouldTrack=!0,this.effectTrackDepth=0,this.frameStack=[],this.triggerStack=[],this.shouldTrigger=!0,this.trackStack=[],this.effectsInSession=new Set,this.effectsInSessionPayloads=new WeakMap,this.inEffectSession=!1,this.isDigesting=!1,this.sessionDepth=0,this.track=(e,n,r)=>{if(!L.activeScopes.at(-1)||!this.shouldTrack)return;let s=this.targetMap.get(e);s||this.targetMap.set(e,s=new Map);let i=s.get(r);i||s.set(r,i=be());const a=void 0;if(N(e)&&At(r)){let o=this.arrayExplicitKeyDepCount.get(e)||0;this.arrayExplicitKeyDepCount.set(e,++o)}return this.trackEffects(i,a),i}}static get instance(){return U._instance||(U._instance=new U)}createEffectSession(){this.isDigesting||(this.inEffectSession=!0,this.sessionDepth++)}scheduleEffect(e,n,r){this.effectsInSession.add(e);let s=this.effectsInSessionPayloads.get(e);s||this.effectsInSessionPayloads.set(e,s=[]),s.push(n)}digestEffectSession(){if(this.isDigesting||(this.sessionDepth--,this.sessionDepth>0))return;this.isDigesting=!0;const e=this.effectsInSession[Symbol.iterator]();let n;for(;n=e.next().value;){const r=this.effectsInSessionPayloads.get(n);n.run(r),this.effectsInSession.delete(n),this.effectsInSessionPayloads.delete(n)}this.inEffectSession=!1,this.isDigesting=!1}trackEffects(e,n){const r=L.activeScopes.at(-1);if(!r)return;let s=!1;this.effectTrackDepth<=de?Ye(e)||(e.n|=U.trackOpBit,s=!Be(e)):s=!e.has(r),s&&(e.add(r),r.deps.push(e),this.frameStack.length&&this.frameStack.at(-1).deps.push(e))}trigger(e,n,r,s){if(!this.shouldTrigger)return;const i={...r,source:e,type:n},{key:a,newValue:o,oldValue:c}=i,l=this.targetMap.get(e);if(!l)return;let h=[];if(n===d.CLEAR)h=[...l.values()];else if(a==="length"&&N(e)){const u=bt(o);l.forEach((p,g)=>{(g==="length"||g>=u)&&h.push(p)})}else switch(a!==void 0&&h.push(l.get(a)),n){case d.ADD:N(e)?ve(a)&&h.push(l.get("length")):(h.push(l.get(H)),h.push(l.get(ie)));break;case d.DELETE:N(e)||(h.push(l.get(H)),h.push(l.get(ie)));break;case d.SET:N(e)||h.push(l.get(H));break;case d.METHOD:h.push(l.get(d.METHOD));break;case d.EXPLICIT_KEY_CHANGE:h.push(l.get(d.EXPLICIT_KEY_CHANGE));break}if(h.length===1)h[0]&&this.triggerEffects(h[0],i);else{const u=[];for(const p of h)p&&u.push(...p);this.triggerEffects(be(u),i)}}triggerEffects(e,n,r){const s=N(e)?e:[...e];for(const i of s)this.triggerEffect(i,n,r)}triggerEffect(e,n,r){this.inEffectSession?this.scheduleEffect(e,n,r):e.run([n],r)}enableTracking(){this.trackStack.push(this.shouldTrack),this.shouldTrack=!0}pauseTracking(){this.trackStack.push(this.shouldTrack),this.shouldTrack=!1}resetTracking(){const e=this.trackStack.pop();this.shouldTrack=e===void 0?!0:e}};Ze.trackOpBit=1;let f=Ze;const ae=new Map;function Pt(t,e){const n=t[1]===void 0?t.length<2?1/0:0:t[1],r=n<0?0:n;return r!==1/0?r:e-t[0]}function _t(t){b(Array.isArray(t),"only array source can have atom indexes");let e=ae.get(t);if(!e){const n=t.map((r,s)=>x(s));e={depCount:0,indexes:n,computed:R(function(){this.manualTrack(t,y.METHOD,d.METHOD)},function(r,s){s.forEach(({method:i,argv:a})=>{if(b(!!i,"trigger info has no method and result"),i==="push"){const o=a.map((c,l)=>x(l+n.length));n.push(...o)}else if(i==="pop")n.pop();else if(i==="shift")n.shift();else if(i==="unshift")n.forEach(o=>o(c=>c+a.length)),n.unshift(...a.map((o,c)=>x(c)));else if(i==="splice"){const o=Pt(a,n.length),c=a.slice(2).map((l,h)=>x(h+a[0]));if(n.splice(a[0],a[1],...c),o!==c.length)for(let l=a[0]+o;l<n.length;l++)n[l](l)}})},function(r){r()})},ae.set(t,e)}return e.depCount++,e.indexes}function Rt(t){const e=ae.get(t);b(!!e,"no dep for this array source found."),e.depCount--,e.depCount<1&&($(e.computed),ae.delete(t))}function Lt(t,e){if(!we(t)){if(Array.isArray(t))return t.map((s,i)=>e(s,()=>i));if(t instanceof Map)return new Map(Object.entries(t).map(([s,i])=>[s,e(i,s)]));if(t instanceof Set)return new Set(Array.from(t).map(e));b(!1,"unknown source type for incMap")}let n,r;return e.length>1&&(f.instance.pauseTracking(),r=Array.isArray(t)?_t(t):void 0,f.instance.resetTracking()),R(function(){const{manualTrack:s,collectEffect:i}=this;if(s(t,y.METHOD,d.METHOD),s(t,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),Array.isArray(t)?this.effectFramesArray=[]:this.keyToEffectFrames=new WeakMap,Array.isArray(t))return t.map((a,o)=>{const c=i(),l=e(a,r==null?void 0:r[o]);return this.effectFramesArray[o]=c(),l});if(t instanceof Map)return new Map(Array.from(t.entries()).map(([a,o])=>{const c=i(),l=e(o,a);return this.keyToEffectFrames.set(a,c()),[a,l]}));if(t instanceof Set){n=new Map;const a=Array.from(t.values()).map(o=>{const c=i(),l=e(o);return this.keyToEffectFrames.set(o,c()),n.set(o,l),l});return new Set(a)}else b(!1,"non-support map source type")},function(s,i){const{collectEffect:a,destroyEffect:o}=this;i.forEach(({method:c,argv:l,result:h,key:u,newValue:p})=>{var g,I,C,A,k;if(b(!!(c==="splice"||h),"trigger info has no method and result"),Array.isArray(t))if(c==="splice"){const m=l.slice(2),E=[],v=m.map((D,S)=>{const B=t[S+l[0]],z=a(),ot=e(B,r==null?void 0:r[S+l[0]]);return E[S]=z(),ot});s.splice(l[0],l[1],...v),this.effectFramesArray.splice(l[0],l[1],...E).forEach(D=>{D.forEach(S=>{o(S)})})}else{const m=u,E=a();s[m]=e(t[m],r==null?void 0:r[m]);const v=E();this.effectFramesArray[m].forEach(D=>{o(D)}),this.effectFramesArray[m]=v}else if(t instanceof Map)if(c==="clear"){const m=Array.from(s.keys());s.clear(),m.forEach(E=>{this.keyToEffectFrames.get(E).forEach(v=>{o(v)})})}else!c&&h&&((g=h.add)==null||g.forEach(({key:m,newValue:E})=>{const v=a();s.set(m,e(E));const D=v();this.keyToEffectFrames.set(m,D)}),(I=h.update)==null||I.forEach(({key:m,newValue:E})=>{const v=a();s.set(m,e(E));const D=v();this.keyToEffectFrames.get(m).forEach(S=>{o(S)}),this.keyToEffectFrames.set(m,D)}),(C=h.remove)==null||C.forEach(({key:m})=>{s.remove(m),this.keyToEffectFrames.get(m).forEach(E=>{o(E)})}));else if(t instanceof Set)if(c==="clear"){const m=Array.from(s.values());s.clear(),m.forEach(E=>{this.keyToEffectFrames.get(E).forEach(v=>{o(v)})})}else!c&&h&&((A=h.add)==null||A.forEach(({newValue:m})=>{const E=a();s.add(e(m));const v=E();this.keyToEffectFrames.set(m,v)}),(k=h.remove)==null||k.forEach(({oldValue:m})=>{const E=n.get(m);s.remove(E),this.keyToEffectFrames.get(m).forEach(v=>{o(v)})}))})},function(s){s()},{onDestroy(){n==null||n.clear(),Array.isArray(t)&&e.length>1&&Rt(t)}})}const Nt=gt(`constructor,__proto__,__v_isAtom,${w.IS_REACTIVE}}`),Qe=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Te)),jt=Gt(),Ie=Ft(),P=new WeakSet;function Ft(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=T(this);for(let i=0,a=this.length;i<a;i++)f.instance.track(r,y.GET,i+"");const s=r[e](...n);return s===-1||s===!1?r[e](...n.map(T)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){const r=T(this),s=r.length;f.instance.pauseTracking(),P.add(r),f.instance.createEffectSession();let i;f.instance.arrayExplicitKeyDepCount.get(r)?i=r[e].apply(this,n):(i=r[e].apply(r,n),f.instance.trigger(r,d.SET,{key:"length",newValue:i.length})),P.delete(r);let a;return e==="splice"?a=n:e==="push"?a=[s,0,...n]:e==="pop"?a=[s-1,1]:e==="shift"?a=[0,1]:e==="unshift"&&(a=[0,0,...n]),f.instance.trigger(r,d.METHOD,{method:"splice",argv:a}),f.instance.digestEffectSession(),f.instance.resetTracking(),i}}),t.$map=function(e){return Lt(this,e)},t}function Gt(t=!1,e=!1){return function(n,r,s){if(r===w.IS_REACTIVE)return!t;if(r===w.IS_ATOM)return!1;if(r===w.IS_READONLY)return t;if(r===w.IS_SHALLOW)return e;if(r===w.RAW&&s===(e?hn:et).get(n))return n;const i=N(n);if(!t&&i&&le(Ie,r))return Reflect.get(Ie,r,s);const a=typeof r=="string"&&r[0]==="$",o=a?r.slice(1,1/0):r,c=Reflect.get(n,o,s);return!Oe(o)&&!(i&&Et(r))&&f.instance.track(n,y.GET,o),a?Kt(n,o):Oe(o)||O(c)||i&&!ve(o)?c:ee(c)?q(c):c}}function Oe(t){return Te(t)?Qe.has(t):Nt(t)}function Kt(t,e){function n(r){if(arguments.length===0)return f.instance.track(t,y.GET,e),Reflect.get(t,e);const s=Reflect.get(t,e);Reflect.set(t,e,r),f.instance.trigger(t,d.SET,{key:e,newValue:r,oldValue:s}),P.has(T(t))||f.instance.trigger(t,d.EXPLICIT_KEY_CHANGE,{result:{update:[{key:e,oldValue:s,newValue:r}]}})}return n.toString=()=>{var r;return f.instance.track(t,y.GET,e),(r=Reflect.get(t,e))==null?void 0:r.toString()},n.valueOf=()=>{var r;return f.instance.track(t,y.GET,e),(r=Reflect.get(t,e))==null?void 0:r.valueOf()},te(n,w.IS_REACTIVE,!0),te(n,w.IS_ATOM,!0),n}const $t=Wt();function Wt(t=!1){return function(e,n,r,s){let i=e[n];if(O(i)&&!O(r))return!1;O(r)&&console.warn(`you are assign an atom to ${n.toString()}`),r=T(r);const a=N(e)&&ve(n)?Number(n)<e.length:le(e,n),o=Reflect.set(e,n,r,s);return e===T(s)&&(a?$e(r,i)&&(f.instance.trigger(e,d.SET,{key:n,newValue:r,oldValue:i}),P.has(T(e))||f.instance.trigger(e,d.EXPLICIT_KEY_CHANGE,{key:n,newValue:r,result:{update:[{key:n,oldValue:i,newValue:r}]}})):(f.instance.trigger(e,d.ADD,{key:n,newValue:r}),P.has(T(e))||f.instance.trigger(e,d.EXPLICIT_KEY_CHANGE,{key:n,newValue:r,result:{add:[{key:n,newValue:r}]}}))),o}}function Bt(t,e){const n=le(t,e),r=t[e],s=Reflect.deleteProperty(t,e);return s&&n&&(f.instance.trigger(t,d.DELETE,{key:e,newValue:void 0,oldValue:r}),P.has(T(t))||f.instance.trigger(t,d.EXPLICIT_KEY_CHANGE,{result:{remove:[{key:e,oldValue:r}]}})),s}function Yt(t,e){const n=Reflect.has(t,e);return(!Te(e)||!Qe.has(e))&&f.instance.track(t,y.HAS,e),n}function Xt(t){return f.instance.track(t,y.ITERATE,N(t)?"length":ie),Reflect.ownKeys(t)}const zt={get:jt,set:$t,deleteProperty:Bt,has:Yt,ownKeys:Xt},ne=t=>Reflect.getPrototypeOf(t);function qt(t,e,n=!1){t=t[w.RAW];const r=T(t),s=T(e);n||(e!==s&&f.instance.track(r,y.GET,e),f.instance.track(r,y.GET,s));const{has:i}=ne(r);if(i.call(r,e))return X(t.get(e));if(i.call(r,s))return X(t.get(s));t!==r&&t.get(e)}function Jt(t,e,n=!1){t=t[w.RAW];const r=T(t),s=T(e);n||(e!==s&&f.instance.track(r,y.GET,e),f.instance.track(r,y.GET,s));const{has:i}=ne(r);if(i.call(r,e))return xe(t,e);if(i.call(r,s))return xe(t,s);b(!1,`can not find key ${e.toString()}`)}function xe(t,e){function n(r){if(arguments.length===0)return f.instance.track(t,y.GET,e),t.get(e);const s=t.get(e);t.set(e,r),f.instance.trigger(t,d.SET,{key:e,newValue:r,oldValue:s}),P.has(T(t))||f.instance.trigger(t,d.EXPLICIT_KEY_CHANGE,{result:{update:[{key:e,oldValue:s,newValue:r}]}})}return n.toString=()=>{var r;return f.instance.track(t,y.GET,e),(r=t.get(e))==null?void 0:r.toString()},n.valueOf=()=>{var r;return f.instance.track(t,y.GET,e),(r=t.get(e))==null?void 0:r.valueOf()},te(n,w.IS_REACTIVE,!0),te(n,w.IS_ATOM,!0),n}function Ut(t,e=!1){const n=this[w.RAW],r=T(n),s=T(t);return e||(t!==s&&f.instance.track(r,y.HAS,t),f.instance.track(r,y.HAS,s)),t===s?n.has(t):n.has(t)||n.has(s)}function Zt(t,e=!1){return t=t[w.RAW],!e&&f.instance.track(T(t),y.ITERATE,H),Reflect.get(t,"size",t)}function Qt(t){t=T(t);const e=T(this);return ne(e).has.call(e,t)||(e.add(t),f.instance.trigger(e,d.ADD,{newValue:t}),P.has(T(e))||f.instance.trigger(e,d.EXPLICIT_KEY_CHANGE,{result:{add:[{newValue:t}]}})),this}function en(t,e){e=T(e);const n=T(this),{has:r,get:s}=ne(n);let i=r.call(n,t);i||(t=T(t),i=r.call(n,t));const a=s.call(n,t);return n.set(t,e),i?$e(e,a)&&(f.instance.trigger(n,d.SET,{key:t,newValue:e,oldValue:a}),P.has(n)||f.instance.trigger(n,d.EXPLICIT_KEY_CHANGE,{result:{update:[{key:t,oldValue:a,newValue:e}]}})):(f.instance.trigger(n,d.ADD,{key:t,newValue:e}),P.has(n)||f.instance.trigger(n,d.EXPLICIT_KEY_CHANGE,{result:{add:[{key:t,oldValue:a}]}})),this}function tn(t){const e=T(this),{has:n,get:r}=ne(e);let s=n.call(e,t);s||(t=T(t),s=n.call(e,t));const i=r?r.call(e,t):void 0,a=e.delete(t);return s&&(f.instance.trigger(e,d.DELETE,{key:t,newValue:void 0,oldValue:i}),P.has(T(e))||f.instance.trigger(e,d.EXPLICIT_KEY_CHANGE,{result:{remove:[{key:t,oldValue:i}]}})),a}function nn(){const t=T(this),e=t.size!==0,n=void 0;P.add(t);const r=t.clear();return P.delete(t),e&&(f.instance.trigger(t,d.CLEAR,{},n),f.instance.trigger(t,d.METHOD,{method:"clear"},n)),r}function rn(t,e){return function(n,r){const s=this,i=s[w.RAW],a=T(i);return!t&&f.instance.track(a,y.ITERATE,H),i.forEach((o,c)=>n.call(r,X(o),X(c),s))}}function sn(t,e,n){return function(...r){const s=this[w.RAW],i=T(s),a=me(i),o=t==="entries"||t===Symbol.iterator&&a,c=t==="keys"&&a,l=s[t](...r);return!e&&f.instance.track(i,y.ITERATE,c?ie:H),{next(){const{value:h,done:u}=l.next();return u?{value:h,done:u}:{value:o?[X(h[0]),X(h[1])]:X(h),done:u}},[Symbol.iterator](){return this}}}}function an(){const t={get(e){return qt(this,e)},$get(e){return Jt(this,e)},get size(){return Zt(this)},has:Ut,add:Qt,set:en,delete:tn,clear:nn,forEach:rn(!1)};return["keys","values","entries",Symbol.iterator].forEach(e=>{t[e]=sn(e,!1)}),[t]}const[He]=an(),on="$get";function cn(t){return(e,n,r)=>n===w.IS_REACTIVE?!t:n===w.IS_READONLY?t:n===w.RAW?e:Reflect.get(le(He,n)&&(n in e||n===on&&e instanceof Map)?He:e,n,r)}const ln={get:cn(!1)},et=new WeakMap,hn=new WeakMap;function un(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function fn(t){return t[w.SKIP]||!Object.isExtensible(t)?0:un(Ct(t))}function q(t,e){const n=[t,!1,zt,ln,et],r=e?e(...n):n;return dn(...r)}q.as=Ht(q);function dn(t,e,n,r,s){if(!vt(t)||t[w.RAW])return t;const i=s.get(t);if(i)return i;const a=fn(t);if(a===0)return t;const o=new Proxy(t,a===2?r:n);return s.set(t,o),o}function we(t){return!!(t&&t[w.IS_REACTIVE])}function T(t){const e=t&&t[w.RAW];return e?T(e):t}const X=t=>We(t)?q(t):t;class oe extends he{constructor(e,n,r,s,i,a,o){super(n,r,s,i,a,o),this.getter=n,this.applyPatch=r,this.callbacks=i,this.skipIndicator=a,this.forceAtom=o,this.replace=c=>{this.data.clear();const l=Array.isArray(c)?c:Object.entries(c);this.data=new Map(l),l.forEach(([h,u])=>{f.instance.trigger(this,d.ADD,{key:h,newValue:u})}),f.instance.trigger(this,d.METHOD,{method:"replace",argv:[c]})},this.replaceData=this.replace,e&&(this.data=me(e)?e:new Map(Array.isArray(e)?e:Object.entries(e)))}set(e,n){const r=this.data.has(e),s=this.data.get(e);this.data.set(e,n),r?f.instance.trigger(this,d.SET,{key:e,newValue:n,oldValue:s}):f.instance.trigger(this,d.ADD,{key:e,newValue:n})}delete(e){if(this.data.has(e)){const n=this.data.get(e);this.data.delete(e),f.instance.trigger(this,d.DELETE,{key:e,newValue:void 0,oldValue:n})}}clear(){const e=Array.from(this.data.entries());this.data.clear(),e.forEach(([n,r])=>{f.instance.trigger(this,d.DELETE,{key:n,oldValue:r})}),f.instance.trigger(this,d.METHOD,{method:"clear"})}get(e){const n=this.data.get(e);return f.instance.track(this,y.GET,e),n}forEach(e){for(let[n,r]of this.data)e(r,n);f.instance.track(this,y.ITERATE,H)}[Symbol.iterator](){let e=0,n=this.data;f.instance.track(this,y.ITERATE,H);const r=Array.from(n.keys());return{next:()=>e<r.length?{value:[this.get(r[e]),r[e]],done:!1}:{done:!0}}}entries(){const e=this,n=[];return new M(null,function(){return this.manualTrack(e,y.ITERATE,H),this.manualTrack(e,y.METHOD,d.METHOD),n.push(...e.data.keys()),Array.from(e.data.entries())},function(r,s){s.forEach(i=>{if(i.type===d.METHOD)i.method==="clear"?(this.splice(0,this.data.length),n.splice(0,n.length)):b(!1,"unreachable");else{const a=i.key,o=i.newValue;if(i.type===d.ADD)this.push([a,o]),n.push(a);else if(i.type===d.SET){const c=n.indexOf(a);this.set(c,[a,o])}else if(i.type===d.DELETE){const c=n.indexOf(a);this.splice(c,1),n.splice(c,1)}else b(!1,"unreachable")}})})}values(){const e=this;return new M(null,function(){return this.manualTrack(e,y.ITERATE,H),this.manualTrack(e,y.METHOD,d.METHOD),Array.from(e.data.values())},function(n,r){r.forEach(s=>{if(s.type===d.METHOD)s.method==="clear"?this.splice(0,this.data.length):b(!1,"unreachable");else if(s.type===d.ADD)this.push(s.newValue);else if(s.type===d.SET){const i=this.data.indexOf(s.oldValue);this.splice(i,1,s.newValue)}else if(s.type===d.DELETE){const i=this.data.indexOf(s.oldValue);this.splice(i,1)}else b(!1,"unreachable")})})}keys(){const e=this;return new M(null,function(){return this.manualTrack(e,y.ITERATE,H),this.manualTrack(e,y.METHOD,d.METHOD),Array.from(e.data.keys())},function(n,r){r.forEach(s=>{if(s.type===d.METHOD)s.method==="clear"?this.splice(0,this.data.length):b(!1,"unreachable");else{const i=s.key;if(s.type===d.ADD)this.push(i);else if(s.type!==d.SET)if(s.type===d.DELETE){const a=this.data.indexOf(i);this.splice(a,1)}else b(!1,"unreachable")}})})}get size(){const e=this;return Q(function(){return this.manualTrack(e,y.ITERATE,H),e.data.size},function(n,r){n(e.data.size)})}}class M extends he{constructor(e,n,r,s,i){super(n,r,s,i,void 0,void 0,!0),this.getter=n,this.applyPatch=r,this.callbacks=i,this.indexKeyDeps=new Map,this.atomIndexesDepCount=0,e&&(this.data=e)}replaceData(e){this.splice(0,this.data.length,...e)}push(...e){return this.splice(this.data.length,0,...e)}pop(){return this.splice(this.data.length-1,1)[0]}shift(){return this.splice(0,1)[0]}unshift(...e){return this.splice(0,0,...e)}splice(e,n,...r){var s,i,a;f.instance.pauseTracking(),f.instance.createEffectSession();const o=this.data.length,c=Math.min(n,o-e)!==r.length?this.data.length:e+r.length,l=[];for(let u=e;u<c;u++)l[u]=this.data[u];const h=this.data.splice(e,n,...r);if(((s=this.indexKeyDeps)==null?void 0:s.size)>0)for(let u=e;u<c;u++)f.instance.trigger(this,d.SET,{key:u,newValue:this.data[u],oldValue:l[u]});if(this.atomIndexes){this.atomIndexes.splice(e,n,...r.map((u,p)=>x(p+e)));for(let u=e;u<c;u++)(a=(i=this.atomIndexes)[u])==null||a.call(i,u)}return f.instance.trigger(this,d.METHOD,{method:"splice",key:H,argv:[e,n,...r],methodResult:h}),f.instance.digestEffectSession(),f.instance.resetTracking(),h}set(e,n){const r=this.data[e];this.data[e]=n,e>this.data.length-1?f.instance.trigger(this,d.ADD,{key:e,newValue:n,oldValue:r}):f.instance.trigger(this,d.SET,{key:e,newValue:n,oldValue:r}),f.instance.trigger(this,d.EXPLICIT_KEY_CHANGE,{key:e,newValue:n,oldValue:r})}at(e){const n=f.instance.track(this,y.GET,e);return n&&!this.indexKeyDeps.has(e)&&this.indexKeyDeps.set(e,n),this.data[e]}forEach(e){for(let n=0;n<this.data.length;n++)e(this.at(n),n);f.instance.track(this,y.ITERATE,H)}[Symbol.iterator](){let e=0,n=this.data;return f.instance.track(this,y.ITERATE,H),{next:()=>e<n.length?{value:this.at(e),done:!1}:{done:!0}}}addAtomIndexesDep(){this.atomIndexesDepCount===0&&(this.atomIndexes=this.data.map((e,n)=>x(n))),this.atomIndexesDepCount++}removeAtomIndexesDep(){this.atomIndexesDepCount--,this.atomIndexesDepCount===0&&(this.atomIndexes=void 0)}map(e,n,r){const s=this;return e.length>1&&s.addAtomIndexesDep(),new M(null,function(){return this.manualTrack(s,y.METHOD,d.METHOD),this.manualTrack(s,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),s.data.map((i,a)=>{var o;const c=L.collectEffect(),l=e(s.at(a),(o=s.atomIndexes)==null?void 0:o[a]);return this.effectFramesArray[a]=c(),l})},function(i,a){a.forEach(o=>{var c;const{method:l,argv:h,key:u}=o;if(b(!!(l==="splice"||u),"trigger info has no method and key"),n&&n(o),l==="splice"){const p=h.slice(2),g=[],I=p.map((C,A)=>{var k;const m=s.at(A+h[0]),E=this.collectEffect(),v=e(m,(k=s.atomIndexes)==null?void 0:k[A+h[0]]);return g[A]=E(),v});this.splice(h[0],h[1],...I),this.effectFramesArray.splice(h[0],h[1],...g).forEach(C=>{C.forEach(A=>{this.destroyEffect(A)})})}else{const p=u,g=this.collectEffect();this.set(p,e(s.at(p),(c=s.atomIndexes)==null?void 0:c[p]));const I=g();this.effectFramesArray[p].forEach(C=>{this.destroyEffect(C)}),this.effectFramesArray[p]=I}})},r,{onDestroy:i=>{e.length>1&&s.removeAtomIndexesDep()}})}reduce(e){const n=this;return new M(null,function(r){this.manualTrack(n,y.METHOD,d.METHOD),this.manualTrack(n,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),this.data=[];for(let s=0;s<n.data.length;s++){const i=L.collectEffect();e(this,n.data[s],s),this.effectFramesArray[s]=i()}return this.data},function(r,s){s.forEach(i=>{const{method:a,argv:o}=i;b(a==="splice"&&o[0]===n.data.length-o.slice(2).length&&o[1]===0,"reduce can only support append");const c=this.data.length,l=o.slice(2);for(let h=0;h<l.length;h++){const u=L.collectEffect();e(this,l[h],h+c),this.effectFramesArray[h]=u()}})})}find(e){const n=this;let r=-1;return Q(function(){return this.manualTrack(n,y.METHOD,d.METHOD),this.manualTrack(n,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),n.data.find((s,i)=>e(s)?(r=i,!0):!1)},function(s,i){i.forEach(a=>{const{method:o,argv:c,key:l}=a;b(!!(o==="splice"||l),"trigger info has no method and key");let h=-1;if(o==="splice"){const u=c[0];r>=u&&(h=u)}else r===l&&(h=l);if(h!==-1){r=-1;for(let u=h;u<n.data.length;u++)if(e(n.data[u])){r=u,s(n.data[u]);return}s(null)}})})}findIndex(e){const n=this;let r=-1;return Q(function(){return this.manualTrack(n,y.METHOD,d.METHOD),this.manualTrack(n,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),n.data.findIndex((s,i)=>e(s)?(r=i,!0):!1)},function(s,i){i.forEach(a=>{const{method:o,argv:c,key:l}=a;b(!!(o==="splice"||l),"trigger info has no method and key");let h=-1;if(o==="splice"){const u=c[0];r>=u&&(h=u)}else r===l&&(h=l);if(h!==-1){r=-1;for(let u=h;u<n.data.length;u++)if(e(n.data[u])){r=u,s(r);return}s(r)}})})}filter(e){const n=this;return new M(null,function(){return this.manualTrack(n,y.METHOD,d.METHOD),this.manualTrack(n,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),n.data.filter(e)},function(r,s){s.forEach(i=>{const{method:a,argv:o,key:c,oldValue:l,methodResult:h}=i;if(b(!!(a==="splice"||c),"trigger info has no method and key"),a==="splice")(h||[]).forEach(u=>{this.data.includes(u)&&this.splice(this.data.indexOf(u),1)}),o.slice(2).forEach(u=>{e(u)&&this.push(u)});else{const u=c,p=n.data[u];e(p)&&this.push(p),this.data.includes(l)&&this.splice(this.data.indexOf(l),1)}})})}groupBy(e){const n=this;return new oe(null,function(){const r=new Map;this.manualTrack(n,y.METHOD,d.METHOD),this.manualTrack(n,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE);for(let s=0;s<n.data.length;s++){const i=n.data[s],a=e(i);r.has(a)||r.set(a,new M([])),r.get(a).push(i)}return r},function(r,s){s.forEach(i=>{const{method:a,argv:o,key:c,oldValue:l,newValue:h,methodResult:u}=i;if(b(!!(a==="splice"||c),"trigger info has no method and key"),a==="splice")(u||[]).forEach(p=>{const g=e(p);this.data.has(g)&&this.data.get(g).splice(this.data.get(g).data.indexOf(p),1)}),o.slice(2).forEach(p=>{const g=e(p);this.data.has(g)||this.data.set(g,new M([])),this.data.get(g).push(p)});else{if(l){const g=e(l);this.data.get(g).splice(this.data.get(g).data.indexOf(l),1)}const p=e(h);this.data.has(p)||this.data.set(p,new M([])),this.data.get(p).push(h)}})})}indexBy(e){const n=this;return new oe(null,function(){const r=new Map;this.manualTrack(n,y.METHOD,d.METHOD),this.manualTrack(n,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE);for(let s=0;s<n.data.length;s++){const i=n.data[s],a=typeof e=="function"?e(i):i[e];b(!r.has(a),"indexBy key is already exist"),r.set(a,i)}return r},function(r,s){s.forEach(i=>{const{method:a,argv:o,key:c,oldValue:l,newValue:h,methodResult:u}=i;if(b(!!(a==="splice"||c),"trigger info has no method and key"),a==="splice")(u||[]).forEach(p=>{const g=typeof e=="function"?e(p):p[e];this.data.delete(g)}),o.slice(2).forEach(p=>{const g=typeof e=="function"?e(p):p[e];b(!this.data.has(g),"indexBy key is already exist"),this.data.set(g,p)});else{const p=typeof e=="function"?e(l):l[e];this.data.delete(p);const g=typeof e=="function"?e(h):h[e];this.data.set(g,h)}})})}get length(){const e=this;return Q(function(){return this.manualTrack(e,y.METHOD,d.METHOD),e.data.length},function(n,r){n(e.data.length)})}onUntrack(e){}createSelection(e,n=!1){return pn(this,e,n)}}function pn(t,e,n=!1){let r=new Map;return new M(null,function(){this.manualTrack(t,y.METHOD,d.METHOD),this.manualTrack(t,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),O(e)?this.manualTrack(e,y.ATOM,"value"):this.manualTrack(e,y.METHOD,d.METHOD);const s=t.data.map((i,a)=>[i,x(!1)]);return s.forEach(([i,a])=>{r.set(i,a)}),(O(e)?e.raw===null?[]:[e.raw]:e.data).forEach(i=>{var a;if(n)(a=s[i])==null||a[1](!0);else{const o=r.get(i);o==null||o(!0)}}),s},function(s,i){i.forEach(a=>{if(a.source===e){O(e)||b(a.method==="splice","currentValues can only support splice");const o=O(e)?a.oldValue===null?[]:[a.oldValue]:a.methodResult||[],c=O(e)?a.newValue===null?[]:[a.newValue]:a.argv.slice(2);if(n)o.forEach(l=>{const h=this.data[l][1];h(!1)}),c.forEach(l=>{const h=this.data[l][1];h==null||h(!0)});else{debugger;o.forEach(l=>{const h=r==null?void 0:r.get(l);h==null||h(!1)}),c.forEach(l=>{const h=r==null?void 0:r.get(l);h==null||h(!0)})}}if(a.source===t){const{method:o,argv:c,key:l,oldValue:h}=a;if(o==="splice"){const u=c[0],p=c[1],g=c.slice(2).length,I=c.slice(2).map(A=>[A,x(!1)]),C=this.splice(u,p,...I);if(C.forEach(([A,k])=>{r.delete(A)}),I.forEach(([A,k])=>{r.set(A,k)}),n){const A=O(e)?[e.raw]:e.data,k=[];A.forEach((m,E)=>{const v=m;if(v>this.data.length-1)k.push(E);else{if(v>=u&&p!==g){const S=v+g-p;r.get(this.data.at(S)[0])(!1)}const D=this.data.at(v)[1];D==null||D(!0)}}),k.length>0&&(O(e)?e(null):k.forEach((m,E)=>{e.splice(k[0]-E,0)}))}else C.forEach(([A,k])=>{O(e)?e.raw===A&&e(null):e.data.indexOf(A)!==-1&&e.splice(e.data.indexOf(A),1)});return}if(r.delete(h),this.data[l]=[t.data[l],x(!1)],n)O(e)?e.raw===l&&this.data[l][1](!0):e.data.includes(l)&&this.data[l][1](!0);else if(O(e))e.raw===h&&e(null);else{const u=e.data.indexOf(h);u!==-1&&e.splice(u,1)}}})},void 0,{onDestroy:s=>{r=null}})}class gn extends L{constructor(e){super(!0),this.fn=e,this.run()}effectFn(){this.fn()}}function or(t){const e=new gn(t);return()=>{e.destroy()}}function yn(){}function De(t){const e=typeof t;return e==="string"||e==="number"}function F(t){function e(...n){var r,s,i;function a(o){var c;if(!((c=a.check)!=null&&c.call(a,o)))return new Error("type check failed")}return a.argv=n,a.stringify=(r=t.stringify)==null?void 0:r.bind(a),a.parse=(s=t.parse)==null?void 0:s.bind(a),a.check=(i=t.check)==null?void 0:i.bind(a),a.is=t.is||(o=>o===e),a.zeroValue=t.zeroValue,a.required=t.required,a.createDefaultValue=t.createDefaultValue,a.coerce=t.coerce,a.required||Object.defineProperty(a,"isRequired",{get(){return F({...t,required:!0,is:a.is})(...n)}}),a.createDefaultValue?Object.defineProperty(a,"defaultValue",{get(){if(a.createDefaultValue)return a.createDefaultValue()}}):Object.defineProperty(a,"default",{get(){return o=>F({...t,required:a.required,createDefaultValue:o,is:a.is})(...n)}}),a.valueType={},a}return e}function G(t,e){const{stringify:n=JSON.stringify,parse:r=JSON.parse,is:s,required:i,...a}=e,o=function(c){if(typeof t=="function"&&!t(c))return new Error(`${c} type check failed`);if(typeof t=="string"&&typeof c!==t)return new Error(`${c} is not ${t}`)};return o.stringify=n,o.parse=r,o.check=c=>typeof t=="string"?typeof c===t:t(c),o.is=s||(c=>c===o),o.required=!!i,Object.assign(o,a),o.required||Object.defineProperty(o,"isRequired",{get(){return G(t,{...e,required:!0,is:o.is})}}),o.createDefaultValue?Object.defineProperty(o,"defaultValue",{get(){if(o.createDefaultValue)return o.createDefaultValue()}}):Object.defineProperty(o,"default",{get(){return c=>G(t,{...e,required:o.required,createDefaultValue:c,is:o.is})}}),o.valueType={},o}const mn=F({stringify(t){return t===null?"":De(this.argv[0][0])?t.toString():JSON.stringify(t)},parse(t){return De(this.argv[0][0])?typeof this.argv[0][0]=="string"?t:parseFloat(t):JSON.parse(t)},check(t){return this.argv[0].includes(t)},zeroValue:[]}),En={zeroValue:""},Tn=G("string",En),kn={stringify(t){return t.toString()},parse(t){if(/-?\d+(\.\d+)?/.test(t))return parseFloat(t);throw new Error(`${t} is not a number`)},zeroValue:0},vn=G("number",kn),wn={zeroValue:null},Cn=G(t=>typeof t=="object"&&!Array.isArray(t),wn),An=G(t=>Array.isArray(t),{}),bn={zeroValue:!1},Sn=G("bool",bn),In={stringify(t){return t.toString()},parse(t){return new Function(t)}},On=G("function",In),xn=G("symbol",{}),Hn={stringify(){throw new Error("type any can not stringify")},parse(){throw new Error("type any can not parse")},check(){throw new Error("type any can not check")}},ue=G(()=>!0,Hn),Dn=F({check(t){return this.argv[0].some(e=>e.check(t))},stringify(t){return this.argv[0].find(e=>!(e(t)instanceof Error)).stringify(t)},parse(t){let e;if(!this.argv[0].some(n=>{try{const r=n.parse(t);if(this.check(r))return e=r,!0}catch{}return!1}))throw new Error(`can not parse ${t}`);return e}}),Mn=F({check(t){return Array.isArray(t)?t.every(e=>this.argv[0].check(e)):!1},stringify(t){},parse(t){},zeroValue:[]}),Vn=F({check(t){return!0},stringify(t){},parse(t){}}),Pn=F({check(t){return Object.entries(this.argv[0]).every(([e,n])=>n.check(t[e]))},stringify(t){return`{${Object.entries(this.argv[0]).map(([e,n])=>`${e}:${JSON.stringify(n.stringify(t[e]))}`).join(",")}`},parse(t){const e=JSON.parse(t);return Object.keys(e).forEach(n=>{e[n]=this.argv[0][n].parse(e[n])}),e}}),_n=ue,Rn=ue,Ln=ue,Nn=yn;function jn(){return F({coerce:t=>O(t)?t:x(t)})()}function Fn(){return F({coerce:t=>t instanceof M?t:new M(t)})()}function Gn(){return F({coerce:t=>t instanceof oe?t:new oe(t)})()}const Y={string:Tn,number:vn,object:Cn,array:An,bool:Sn,function:On,symbol:xn,node:_n,element:Rn,elementType:Ln,oneOf:mn,oneOfType:Dn,arrayOf:Mn,shapeOf:Vn,map:Pn,any:ue,checkPropTypes:Nn,atom:jn,rxList:Fn,rxMap:Gn};function Kn(t,e){const n=t[1]===void 0?t.length<2?1/0:0:t[1],r=n<0?0:n;return r!==1/0?r:e-t[0]}class $n{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.createHost=([s,i])=>W(s,i,{...this.pathContext,hostPath:[...this.pathContext.hostPath,this]})}createPlaceholder(e){return[e,document.createComment("frag item host")]}isOnlyChildrenOfParent(){const e=this.placeholder.parentElement;return(e==null?void 0:e.lastChild)===this.placeholder&&e.firstChild===this.element}get element(){var e,n;return((n=(e=this.hostsComputed)==null?void 0:e[0])==null?void 0:n.element)||this.placeholder}render(){const e=this;this.placeholderAndItemComputed=R(function(){if(this.manualTrack(e.source,y.METHOD,d.METHOD),this.manualTrack(e.source,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),e.hostsComputed)throw new Error("should never recompute reactiveArray");return e.source.map(e.createPlaceholder)},function(n,r){r.forEach(({method:s,argv:i,result:a})=>{var o,c,l;if(s==="push"){const h=i.map(e.createPlaceholder);n.push(...h)}else if(s==="pop")n.pop();else if(s==="shift")n.shift();else if(s==="unshift"){const h=i.map(e.createPlaceholder);n.unshift(...h)}else if(s==="splice"){const h=i.slice(2).map(e.createPlaceholder);n.splice(i[0],i[1],...h)}else if(!s&&a)(o=a.add)==null||o.forEach(({})=>{throw new Error("can not use obj[key] = value to add item to reactive array, use push instead.")}),(c=a.remove)==null||c.forEach(({})=>{throw new Error("can not use delete obj[key] to delete item, use splice instead.")}),(l=a.update)==null||l.forEach(({key:h,newValue:u})=>{n[h]=e.createPlaceholder(u)});else throw new Error("unknown trigger info")})},function(n){n()}),this.hostsComputed=R(function(){var n;if((n=e.hostsComputed)!=null&&n.length)throw new Error("hostsComputed should not recompute");this.manualTrack(e.placeholderAndItemComputed,y.METHOD,d.METHOD),this.manualTrack(e.placeholderAndItemComputed,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE);const r=e.placeholderAndItemComputed.map(([i,a])=>W(i,a,{...e.pathContext,hostPath:[...e.pathContext.hostPath,e]})),s=document.createDocumentFragment();return r.forEach(i=>{s.appendChild(i.placeholder),i.render()}),_(s,e.placeholder),r},function(n,r){r.forEach(({method:s,argv:i,result:a})=>{var o,c,l,h;if(s==="push"){const u=i.map(e.createHost),p=document.createDocumentFragment();u.forEach(g=>{p.appendChild(g.placeholder),g.render()}),_(p,e.placeholder),n.push(...u)}else if(s==="pop")n.pop().destroy();else if(s==="shift")n.shift().destroy();else if(s==="unshift"){const u=i.map(e.createHost),p=document.createDocumentFragment();u.forEach(g=>{p.appendChild(g.placeholder),g.render()}),_(p,e.element),n.unshift(...u)}else if(s==="splice"){const u=document.createDocumentFragment(),p=i.slice(2).map(e.createHost);if(p.forEach(g=>{u.appendChild(g.placeholder),g.render()}),i[0]===0&&i[1]>=n.length&&e.isOnlyChildrenOfParent()){const g=e.placeholder.parentNode;!p.length&&g instanceof HTMLElement?(g.innerHTML="",g.appendChild(u)):g.replaceChildren(u),g.appendChild(e.placeholder),n.forEach(I=>I.destroy(!0)),n.splice(0,1/0,...p)}else{const g=Kn(i,n.length);_(u,((o=n[i[0]+g])==null?void 0:o.element)||e.placeholder),n.splice(i[0],g,...p).forEach(I=>I.destroy())}}else if(!s&&a)(c=a.add)==null||c.forEach(({})=>{throw new Error("should never occur")}),(l=a.remove)==null||l.forEach(({})=>{throw new Error("should never occur")}),(h=a.update)==null||h.forEach(({key:u,newValue:p})=>{var g;n[u].destroy(),n[u]=e.createHost(p),_(n[u].placeholder,((g=n[parseInt(u,10)+1])==null?void 0:g.element)||e.placeholder),n[u].render()});else throw new Error("unknown trigger info")})},function(n){n()})}destroy(e,n){n||($(this.hostsComputed),$(this.placeholderAndItemComputed)),this.hostsComputed.forEach(r=>r.destroy(e)),e||this.placeholder.remove()}}const Me=new WeakSet;function Wn({container:t,content:e,destroyOnUnmount:n},{useEffect:r,pathContext:s}){typeof e!="function"&&(Me.has(e)&&console.error("static portal content can only be rendered once. Use function content for content has reactive parts."),Me.add(e));const i=ir(t,s);return i.render(e),r(()=>()=>{i.destroy()}),null}function Bn(){return{current:null}}function Yn(){const t=x(null);return new Proxy({},{get:(e,n)=>{if(n==="current")return t()},set:(e,n,r)=>(n==="current"&&t(r),!0)})}function ce(t){return t?Array.isArray(t)?t:[t]:[]}function Ve(t,e){return Object.entries(e).forEach(([n,r])=>{const s=t[n];s&&(n.startsWith("on")||n==="ref"||n==="style")?n==="style"?t[n]=ce(s).concat(r):t[n]=ce(r).concat(s):t[n]=r}),t}const Xn="$$config",tt=class Z{constructor({type:e,props:n={},children:r},s,i){this.placeholder=s,this.pathContext=i,this.layoutEffects=new Set,this.effects=new Set,this.destroyCallback=new Set,this.layoutEffectDestroyHandles=new Set,this.refs=q({}),this.itemConfig={},this.frame=[],this.exposed={},this.createHTMLOrSVGElement=(o,c,l,...h)=>{var u,p,g;const I=typeof c=="function",C=l==null?void 0:l.as;if(l==null||delete l.as,j(C!=="self",'"self" is reserved, please use another element name.'),C&&(u=this.itemConfig[C])!=null&&u.use&&((p=this.itemConfig[C])==null?void 0:p.use)instanceof Element)return this.itemConfig[C].use;const A={};let k=h;for(const S in l)S.startsWith("$self:")&&(A[S.slice(6)]=l[S],delete l[S]);let m=Ve(l,A);const E=this.itemConfig[C];C&&E&&(E.props&&(I?m={...l,...E.props}:m=Ve(l,E.props)),E.propMergeHandles&&Object.entries(E.propMergeHandles).forEach(([S,B])=>{m[S]=B(m[S],m)}),E.propsMergeHandle&&(m=E.propsMergeHandle(m)),E.children&&(k=E.children));const v=((g=this.itemConfig[C])==null?void 0:g.use)||c;if(!I&&typeof v=="function"){const S=Object.keys(m||{}),B={};S.forEach(z=>{z.startsWith("prop:")&&(B[z.slice(5)]=m[z],delete m[z])}),B[qn]=m,m=B}typeof v=="function"&&E!=null&&E.config&&(m={...m,...E.config}),C&&I&&(m.ref=ce(m.ref).concat(S=>this.refs[C]=S));const D=o?pt(v,m,...k):V(v,m,...k);return C&&!I&&(this.refs[C]=D),D},this.createElement=this.createHTMLOrSVGElement.bind(this,!1),this.createSVGElement=this.createHTMLOrSVGElement.bind(this,!0),this.createPortal=(o,c)=>V(Wn,{container:c,content:o}),this.useLayoutEffect=o=>{this.layoutEffects.add(o)},this.useEffect=o=>{this.effects.add(o)},this.createRef=Bn,this.createRxRef=Yn,this.cleanupsOfExternalTarget=new Set,this.createStateFromRef=(o,c)=>{let l;const h=p=>{c&&l&&this.cleanupsOfExternalTarget.delete(l),l==null||l(),p!==null?(l=o(p,u),c&&l&&this.cleanupsOfExternalTarget.add(l)):(l=void 0,u(null))},u=new Proxy(x(null),{get:(p,g)=>g==="ref"?h:p[g]});return c&&u.ref(c),u},this.expose=(o,c)=>(typeof o=="object"&&c===void 0?Object.assign(this.exposed,o):typeof c=="string"&&(this.exposed[c]=o),o),this.onCleanup=o=>{this.destroyCallback.add(o)},this.runLayoutEffect=()=>{this.layoutEffects.forEach(o=>{const c=o();typeof c=="function"&&this.layoutEffectDestroyHandles.add(c)})},Z.typeIds.has(e)||Z.typeIds.set(e,Z.typeIds.size),this.name=e.name,this.type=e,this.props={};const a=Object.assign({},...this.evaluateBoundProps(),n);Object.entries(a).forEach(([o,c])=>{if(o===Xn)this.itemConfig=c;else if(o[0]==="$"){const[l,h]=o.slice(1).split(":");this.itemConfig[l]||(this.itemConfig[l]={}),h==="_eventTarget"?this.itemConfig[l].eventTarget=ce(c):h==="_use"?this.itemConfig[l].use=c:h==="_props"?this.itemConfig[l].propsMergeHandle=c:h==="_children"?this.itemConfig[l].children=c:h===void 0||h===""?this.itemConfig[l].config=c:(h==null?void 0:h[0])==="_"?j(!1,`unsupported config item: ${l}`):h.endsWith("_")?(this.itemConfig[l].propMergeHandles||(this.itemConfig[l].propMergeHandles={}),this.itemConfig[l].propMergeHandles[h.slice(0,-1)]=c):(this.itemConfig[l].props||(this.itemConfig[l].props={}),this.itemConfig[l].props[h]=c)}else this.props[o]=c}),this.children=r}get typeId(){return Z.typeIds.get(this.type)}get parentElement(){return this.placeholder.parentElement}get element(){var e;return((e=this.innerHost)==null?void 0:e.element)||this.placeholder}evaluateBoundProps(){return(this.type.boundProps||[]).map(e=>typeof e=="function"?e():e)}handleProps(e,n){const r={};return Object.entries(e).forEach(([s,i])=>{var a;n[s]!==void 0?r[s]=((a=i.coerce)==null?void 0:a.call(i,n[s]))||n[s]:r[s]=i.defaultValue}),r}attachRef(e){const n={...this.exposed,refs:this.refs};typeof e=="function"?e(n):e.current=n}attachThis(e){typeof e=="function"?e(this):e.current=this}detachRef(e){typeof e=="function"?e(null):e.current=null}render(){this.element!==this.placeholder&&j(!1,"should never rerender"),this.renderContext={Fragment:Ge,createElement:this.createElement,createSVGElement:this.createSVGElement,refs:this.refs,useLayoutEffect:this.useLayoutEffect,useEffect:this.useEffect,pathContext:this.pathContext,context:new zn(this.pathContext.hostPath),createPortal:this.createPortal,createRef:this.createRef,createRxRef:this.createRxRef,createStateFromRef:this.createStateFromRef,onCleanup:this.onCleanup,expose:this.expose};const{ref:e,...n}=this.props,r=L.collectEffect(),s={...this.type.propTypes?this.handleProps(this.type.propTypes,n):n,children:this.children},i=this.type(s,this.renderContext);this.frame=r(),this.innerHost=W(i,this.placeholder,{...this.pathContext,hostPath:[...this.pathContext.hostPath,this]}),this.innerHost.render(),this.props.ref&&this.attachRef(this.props.ref),this.props.__this&&this.attachThis(this.props.__this),this.effects.forEach(a=>{const o=a();typeof o=="function"&&this.destroyCallback.add(o)}),this.pathContext.root.attached?this.runLayoutEffect():this.deleteLayoutEffectCallback=this.pathContext.root.on("attach",this.runLayoutEffect)}destroy(e,n){var r,s;this.props.ref&&this.detachRef(this.props.ref),n||(r=this.frame)==null||r.forEach(i=>i.destroy()),this.innerHost.destroy(e,n),this.layoutEffectDestroyHandles.forEach(i=>i()),this.destroyCallback.forEach(i=>i()),this.cleanupsOfExternalTarget.forEach(i=>i()),this.cleanupsOfExternalTarget.clear(),e||this.placeholder.remove(),(s=this.deleteLayoutEffectCallback)==null||s.call(this)}};tt.typeIds=new Map;let Ce=tt;class zn{constructor(e){this.hostPath=e,this.valueByType=new Map}get(e){for(let n=this.hostPath.length-1;n>=0;n--){const r=this.hostPath[n];if(r instanceof Ce&&r.renderContext.context.valueByType.has(e))return r.renderContext.context.valueByType.get(e)}}set(e,n){this.valueByType.set(e,n)}}const qn="__nativeAttrs";function Pe(t){return t!=null&&t.toString?t.toString():t===void 0?"undefined":JSON.stringify(t)}class Jn{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.element=this.placeholder}get parentElement(){return this.placeholder.parentNode||this.element.parentElement}replace(e){if(this.element===this.placeholder){const n=document.createTextNode(Pe(e));this.parentElement.replaceChild(n,this.placeholder),this.element=n}else this.element.nodeValue=Pe(e)}render(){this.computed=R(()=>{this.replace(this.source())},void 0,void 0,void 0,this.pathContext.skipIndicator)}destroy(e,n){n||$(this.computed),e||(this.element.remove(),this.placeholder.remove())}}class Un{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.fragmentParent=document.createDocumentFragment()}get parentElement(){return this.placeholder.parentElement||this.fragmentParent}get element(){var e;return((e=this.innerHost)==null?void 0:e.call(this).element)||this.placeholder}render(){this.innerHost=Q(()=>{const n=this.source(),r=document.createComment("computed node");return _(r,this.placeholder),W(n,r,{...this.pathContext,hostPath:[...this.pathContext.hostPath,this]})});let e;this.renderComputed=R(()=>{e&&e.destroy(!1,!1),e=this.innerHost(),f.instance.pauseTracking(),e.render(),f.instance.resetTracking()})}destroy(e,n){const r=this.innerHost();n||($(this.renderComputed),$(this.innerHost)),r==null||r.destroy(e,!n),e||this.placeholder.remove()}}const Zn=V.isValidAttribute;V.isValidAttribute=function(t,e){return t.startsWith("on")?!0:Array.isArray(e)&&e.some(_e)||_e(e)?!1:Zn(t,e)};function _e(t){return we(t)||O(t)||typeof t=="function"}function Re(t){return O(t)||typeof t=="function"}function nt(t){return Array.isArray(t)?t.some(nt):Object.entries(t).some(([e,n])=>e.startsWith(":")||typeof n=="object"&&n!==null)}class Qn{constructor(){this.styleScripts=new Map,this.elToStyleId=new WeakMap}getStyleSheetId(e,n,r){if(r){const o=this.elToStyleId.get(r);if(o)return o;{const c=`gen-${Math.random().toString(36).slice(2)}`;return this.elToStyleId.set(r,c),c}}const s=e.findLastIndex(o=>o instanceof Ce),i=s===-1?void 0:e[s],a=s===-1?e:e.slice(s+1);return`gen-${(i==null?void 0:i.typeId)??"global"}-${a.map(o=>o.pathContext.elementPath.join("_")).join("-")}-${n.join("_")}`}stringifyStyleObject(e){return Object.entries(e).map(([n,r])=>{const s=n.replace(/([A-Z])/g,"-$1").toLowerCase();return typeof r=="number"&&Fe.test(n)?`${s}:${r}px;`:`${s}:${r};`}).join(`
`)}update(e,n,r,s,i=!1){const a=this.getStyleSheetId(e,n,i?null:s);let o=this.styleScripts.get(a);o||(o=document.createElement("style"),document.head.appendChild(o),this.styleScripts.set(a,o)),o.innerHTML=this.generateStyleContent(`.${a}`,r),s.classList.add(a)}generateStyleContent(e,n){const r=Object.keys(n).filter(c=>typeof n[c]!="object"),s=Object.keys(n).filter(c=>typeof n[c]=="object"),i=Object.fromEntries(r.map(c=>[c,n[c]])),a=`${e} {
${this.stringifyStyleObject(i)}
}
`,o=s.map(c=>{if(c.startsWith("@"))return`${c} {
    ${this.generateStyleContent(e,n[c])}
}`;const l=/^(\s?)+&/.test(c)?c.replace("&",e):`${e} ${c}`;return this.generateStyleContent(l,n[c])}).join(`
`);return a+o}}function rt(t){return Array.isArray(t)?t.every(rt):typeof t=="object"}const st=class it{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.computed=void 0,this.element=this.placeholder,this.attachRefs=()=>{var s;(s=this.refHandles)==null||s.forEach(({handle:i,el:a})=>{V.attachRef(a,i)})}}get parentElement(){return this.placeholder.parentElement}render(){if(j(this.element===this.placeholder,"should never rerender"),this.element=this.source instanceof DocumentFragment?document.createComment("fragment start"):this.source,_(this.source,this.placeholder),this.collectInnerHost(),this.collectReactiveAttr(),this.collectReactiveAttr(),this.collectRefHandles(),this.reactiveHosts.forEach(e=>e.render()),this.pathContext.root.attached)this.attachRefs();else{debugger;this.pathContext.root.on("attach",this.attachRefs)}}collectInnerHost(){const e=this.source;if(!(e instanceof HTMLElement||e instanceof DocumentFragment||e instanceof SVGElement))return;const{unhandledChildren:n}=e;this.reactiveHosts=n?n.map(({placeholder:r,child:s,path:i})=>W(s,r,{...this.pathContext,hostPath:[...this.pathContext.hostPath,this],elementPath:i})):[]}collectReactiveAttr(){const e=this.source;if(!(e instanceof HTMLElement||e instanceof DocumentFragment||e instanceof SVGElement))return;const n=e instanceof SVGElement,{unhandledAttr:r}=e;this.attrComputeds=[],r==null||r.forEach(({el:s,key:i,value:a,path:o})=>{this.attrComputeds.push(R(()=>{const c=Array.isArray(a)?a.map(l=>Re(l)?l():l):Re(a)?a():a;if(i==="style"&&nt(c)){const l=rt(a),h=Array.isArray(c)?Object.assign({},...c):c;it.styleManager.update(this.pathContext.hostPath,o,h,s,l)}else ye(s,i,c,n)}))})}collectRefHandles(){const e=this.source;if(!(e instanceof HTMLElement||e instanceof DocumentFragment||e instanceof SVGElement))return;const{refHandles:n}=e;this.refHandles=n}destroy(e,n){var r,s,i;n||(r=this.attrComputeds)==null||r.forEach(a=>$(a)),(s=this.reactiveHosts)==null||s.forEach(a=>a.destroy(!0,n)),(i=this.refHandles)==null||i.forEach(({handle:a})=>{V.detachRef(a)}),e||Ne(this.element,this.placeholder,!0)}};st.styleManager=new Qn;let er=st;class tr{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.computed=void 0,this.childHosts=[]}get parentElement(){return this.placeholder.parentElement}get element(){var e;return((e=this.firstChild)==null?void 0:e.element)||this.firstChild||this.placeholder}render(){if(this.element===this.placeholder){const e=document.createDocumentFragment();this.source.forEach((n,r)=>{if(typeof n=="string"||typeof n=="number"){const s=document.createTextNode(n.toString());e.appendChild(s),r===0&&(this.firstChild=s)}else if(n instanceof Text)e.appendChild(n),r===0&&(this.firstChild=n);else{const s=document.createComment("array item");e.appendChild(s);const i=W(n,s,{...this.pathContext,hostPath:[...this.pathContext.hostPath,this]});this.childHosts.push(i),r===0&&(this.firstChild=i)}}),this.childHosts.forEach(n=>n.render()),_(e,this.placeholder)}else throw new Error("should never rerender")}destroy(e,n){e||(Ne(this.element,this.placeholder,!0),this.childHosts.forEach(r=>r.destroy(!0,n)))}}class nr{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r}createPlaceholder(e){return[e,document.createComment("frag item host")]}isOnlyChildrenOfParent(){const e=this.placeholder.parentElement;return(e==null?void 0:e.lastChild)===this.placeholder&&e.firstChild===this.element}get element(){var e,n;return((n=(e=this.hosts)==null?void 0:e.at(0))==null?void 0:n.element)||this.placeholder}renderNewHosts(e){const n=document.createDocumentFragment();return e.forEach(r=>{n.appendChild(r.placeholder),r.render()}),n}render(){const e=this;this.hosts=this.source.map(n=>W(n,document.createComment("rx list item"),{...this.pathContext,hostPath:[...this.pathContext.hostPath,this]}),({method:n,argv:r,result:s,key:i,newValue:a})=>{if(n==="splice"){const o=this.hosts.data.slice(r[0],r[0]+r[1]),c=this.isOnlyChildrenOfParent();if(o.length===this.hosts.length()&&c){const l=this.placeholder.parentNode;l instanceof HTMLElement&&(l.innerHTML=""),l.appendChild(this.placeholder),o.forEach(h=>h.destroy(!0))}else o.forEach(l=>l.destroy())}else if(i)this.hosts.at(i).destroy();else throw new Error("unknown trigger info")}),this.hostRenderComputed=R(function(){return this.manualTrack(e.hosts,y.METHOD,d.METHOD),this.manualTrack(e.hosts,y.EXPLICIT_KEY_CHANGE,d.EXPLICIT_KEY_CHANGE),_(e.renderNewHosts(e.hosts),e.placeholder),null},function(n,r){r.forEach(({method:s,argv:i,result:a,key:o,newValue:c})=>{var l;if(s==="splice"){const h=e.hosts.at(i[0]+i.slice(2).length),u=i.slice(2),p=e.renderNewHosts(u);_(p,(h==null?void 0:h.element)||e.placeholder)}else if(!s&&o){const h=o;_(e.hosts.at(h).placeholder,((l=e.hosts.at(h+1))==null?void 0:l.element)||e.placeholder),e.hosts.at(h).render()}else throw new Error("unknown trigger info")})})}destroy(e,n){var r;n||((r=this.hosts)==null||r.destroy(),$(this.hostRenderComputed)),this.hosts.forEach(s=>s.destroy(e)),e||this.placeholder.remove()}}class rr{constructor(e){this.pathContext=e,this.element=document.createComment("empty"),this.placeholder=this.element}render(){}destroy(e){e||this.placeholder.remove()}}class sr{constructor(e,n,r){this.source=e,this.placeholder=n,this.pathContext=r,this.element=this.placeholder}render(){this.element=document.createTextNode(this.source.toString()),_(this.element,this.placeholder)}destroy(e){e||this.placeholder.remove(),this.element.remove()}}function W(t,e,n){if(!(e instanceof Comment))throw new Error("incorrect placeholder type");let r;return t instanceof M?r=new nr(t,e,n):Array.isArray(t)?we(t)?r=new $n(t,e,n):r=new tr(t,e,n):typeof t=="object"&&typeof(t==null?void 0:t.type)=="function"?r=new Ce(t,e,n):O(t)?r=new Jn(t,e,n):typeof t=="function"?r=new Un(t,e,n):t instanceof HTMLElement||t instanceof SVGElement||t instanceof DocumentFragment?r=new er(t,e,n):t==null?r=new rr(n):typeof t=="string"||typeof t=="number"||typeof t=="boolean"?r=new sr(t,e,n):j(!1,`unknown child type ${t}`),r}function ir(t,e){const n=new Map,r=e||{hostPath:[],elementPath:[]},s={element:t,pathContext:r,host:void 0,attached:!1,render(i){const a=document.createComment("root");t.appendChild(a),s.host=W(i,a,r),s.host.render();debugger;return document.body.contains(t)&&(s.dispatch("attach"),s.attached=!0),s.host},destroy(){var i;n.clear(),s.dispatch("detach"),(i=s.host)==null||i.destroy(),s.attached=!1},on(i,a){let o=n.get(i);return o||n.set(i,o=new Set),o.add(a),()=>{o.delete(a)}},dispatch(i,a){var o;(o=n.get(i))==null||o.forEach(c=>c(a))}};return r.root=s,s}function at(t){return e=>n=>{if(t(n))return e(n)}}const cr=at(t=>t.key==="Enter"),lr=at(t=>t.button===0);function hr(t){return e=>{e.stopPropagation(),t(e)}}Y.string.isRequired,Y.rxMap(),Y.any.isRequired,Y.function,Y.function,Y.function,Y.function;const ur=Symbol("ModalContext");function fr(t){return(e,n)=>{if(e===window){(()=>{const i={right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight};return re(i,n())||n(i),i})();return}const r=e,s=()=>{const i=r.getBoundingClientRect(),a={top:i.top,left:i.left,right:i.right,bottom:i.bottom};return re(a,n())||n(a),a};if(Array.isArray(t)){const i=[];return t.forEach(a=>{const o=()=>s();a.target.addEventListener(a.event,o),i.push(()=>a.target.removeEventListener(a.event,o))}),()=>{i.forEach(a=>a())}}else if(t==="requestAnimationFrame"){const i=window.requestAnimationFrame(s);return()=>{window.cancelAnimationFrame(i)}}else if(t==="requestIdleCallback"){const i=window.requestIdleCallback(s);return()=>{window.cancelIdleCallback(i)}}else if(t.type==="interval"){const i=window.setInterval(s,t.duration||1e3);return()=>{window.clearInterval(i)}}else j(!1,"invalid options.position")}}const pe=new WeakMap,Le=new ResizeObserver(t=>{t.forEach(e=>{const n=e.target,r=pe.get(n);if(r){const s={width:e.contentRect.width,height:e.contentRect.height,borderBoxWidth:e.borderBoxSize[0].inlineSize,borderBoxHeight:e.borderBoxSize[0].blockSize,contentBoxWidth:e.contentBoxSize[0].inlineSize,contentBoxHeight:e.contentBoxSize[0].blockSize};re(s,r())||r(s)}})});function dr(t,e){if(t===window){const n=()=>{const r={width:window.innerWidth,height:window.innerHeight};return re(r,e())||e(r),r};return window.addEventListener("resize",n),n(),()=>{e(null),window.removeEventListener("resize",n)}}else{Le.observe(t),pe.set(t,e);const n=t.getBoundingClientRect();return e({width:n.width,height:n.height}),()=>{Le.unobserve(t),pe.delete(t),e(null)}}}function pr(t,e){const n=()=>{e(!0)},r=()=>{e(!1)};return t.addEventListener("focusin",n),t.addEventListener("focusout",r),()=>{t.removeEventListener("focusin",n),t.removeEventListener("focusout",r)}}const gr={primaryBlue:"#2F51FF",inputBg:"#15181F",innerBorder:"#2A2C33",panelBorder:"#C5C5C5",panelBg:"#1E1F24",itemBg:"#34394E",description:"#C5C5C5",line:"#A6A6A6"},ge={small:8,medium:12,large:16,extra:24,ultra:32},ar={gradientBg:{background:"linear-gradient(to bottom right, #7A04F0, #1F43FE)"},formItem:{"$labelContainer:style":{fontSize:14,marginBottom:ge.medium},"$labelRequired:style":{color:"red",marginLeft:4}}};function yr({children:t,primary:e},{createElement:n}){const r={background:e?ar.gradientBg.background:"#2A2C33",outline:"none",color:"white",border:e?"none":"1px solid #545863",borderRadius:4,padding:`${ge.small}px ${ge.extra}px`,fontSize:14,cursor:"pointer",userSelect:"none"};return n("button",{as:"main",style:r},t)}export{yr as B,x as D,or as H,ur as J,lr as K,M as P,dr as Q,cr as V,Y as X,fr as Z,ir as a,pn as b,gr as c,ge as g,oe as l,hr as q,ar as s,pr as t,V as v};
